<!DOCTYPE html>
<html lang="en">


<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="never">
<!--可以让img标签预加载网络图片-->
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Leaning and function with your new object.">
    <meta name="keywords" content="BY, BY Blog, 敬方的个人博客, OpenCV, 王鹏程, Qt, C++, 流媒体，计算机视觉，高性能计算">
    <meta name="theme-color" content="#000000">
    
    <title>libx264 学习笔记 - 敬方的个人博客 | BY Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Safari Webpage Icon    by-BY -->
    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://wangpengcheng.github.io//2019/04/19/libx264_learn_note/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://wangpengcheng.github.io//css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://wangpengcheng.github.io//css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="https://wangpengcheng.github.io//css/syntax.css" type="text/css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">My Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-ios10.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-ios10.jpg')
    }

    
</style>
<header class="intro-header">
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#x264" title="x264">x264</a>
                        
                        <a class="tag" href="/tags/#C++" title="C++">C++</a>
                        
                        <a class="tag" href="/tags/#libx264" title="libx264">libx264</a>
                        
                    </div>
                    <h1>libx264 学习笔记</h1>
                    
                    
                    <h2 class="subheading">libx264 的学习笔记</h2>
                    
                    <span class="meta">Posted by 王鹏程 on April 19, 2019</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<h1 id="libx264解码学习笔记">libx264解码学习笔记</h1>
<p><em>参考连接：</em><a href="https://code.videolan.org/videolan/x264">libx264源码地址</a>;<a href="https://www.videolan.org/developers/x264.html">x264主页</a>;<a href="https://blog.csdn.net/leixiaohua1020/article/details/45536607">x264源代码简单分析</a>;</p>

<p>音视频编码在流媒体和网络领域占有重要地位；流媒体编解码流程大致如下图所示：</p>

<p><img src="https://img-blog.csdn.net/20180516184837257?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2dvX3N0cg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="视频编解码流程图"></p>

<h2 id="x264原理解析">x264原理解析</h2>
<p><em>参考链接：</em> <a href="https://baike.baidu.com/item/x264/10787441?fr=aladdin">x264百度词条</a>;<a href="https://blog.csdn.net/garrylea/article/details/78536775">H264基本原理</a>;</p>

<h3 id="h264简介">H264简介</h3>
<p>H.264从1999年开始，到2003年形成草案，最后在2007年定稿有待核实。在ITU的标准里称为H.264，在MPEG的标准里是MPEG-4的一个组成部分–MPEG-4 Part 10，又叫Advanced Video Codec，因此常常称为MPEG-4 AVC或直接叫AVC。x264主要使用算法为H264编解码算法，下面对H264算法进行解析；</p>

<h3 id="h264-编解码解析">H264 编解码解析</h3>
<p><em>参考链接：</em> <a href="https://blog.csdn.net/qq_19923217/article/details/83348095">H264 编解码协议详解</a>;<a href="https://www.jianshu.com/p/9522c4a7818d">深入浅出理解视频编码H264结构</a>;<a href="http://read.pudn.com/downloads147/ebook/635957/%E6%96%B0%E4%B8%80%E4%BB%A3%E8%A7%86%E9%A2%91%E5%8E%8B%E7%BC%A9%E7%BC%96%E7%A0%81%E6%A0%87%E5%87%86H.264.pdf">详细文档</a>;<a href="https://blog.csdn.net/u014253011/article/details/79967520">H264编解码框图</a>;</p>

<h4 id="h264编码原理">H264编码原理：</h4>
<p>在音视频传输过程中，视频文件的传输是一个极大的问题；一段分辨率为1920<em>1080,帧率是25的视频，对于传输带宽的要求是：1920</em>1080<em>25/8/1024/1024=6.179MB，意味着视频每秒带宽为6.179MB这基本是不肯能的。因此视频压缩和编码技术应运而生。
对于视频文件来说，视频由单张图片帧所组成，每秒25/32帧，但是图片帧的像素块之间存在相似性，因此视频帧图像可以进行图像压缩；H264采用了16</em>16的分块大小对，视频帧图像进行相似比较和压缩编码。如下图所示：</p>

<p><img src="https://img-blog.csdnimg.cn/2019012114350437.png" alt="16*16像素块分割"></p>

<p>除此之外，对于一段连续的帧图像来说，前一帧和后一帧之间的关联度和相似性很高，只记录当前帧和下一帧与当前帧之间的帧数据差，能够快速的帮助我们实现视频压缩编解码。为了方便图像之间的压缩，将原图像当前帧设置为Fn,下一帧设置为Fn-1；对Fn进行帧内相似压缩编码，使用估计函数进行重新映射（图像还原）;再利用当前帧对图和帧差信息对下一帧图片进行估计和还原。具体编码框架如下图：</p>

<p><img src="https://img-blog.csdn.net/20180416220957998?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQyNTMwMTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="H264编码流程图"></p>

<p>在上图中，输入的帧或场Fn以宏块为单位被编码器处理。首先，按帧内或者帧间预測编码的方法进行处理。假设採用帧间预測编码，其预測值PRED是由当前片中前面已编码的參考图像经运动补偿（MC）后得到，当中參考图像用F’n-1表示。预測值PRED和当前块相减后，产生一个残差块Dn，经块变换、量化后产生一组量化后的变换系数X，再经熵编码，与解码所需的一些头信息一起组成压缩后的码流，经NAL（网络自适应层）供传输和存储用。</p>

<p>在进行编码过后H264也提供了相应的解码方式，解码流程如下图：</p>

<p><img src="https://img-blog.csdn.net/20180416221016950?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQyNTMwMTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="H264 解码流程"></p>

<p>将编码器的NAL输出的H264比特流经熵解码得到量化后的一组变换系数X，再经反量化、反变换，得到残差D’n。利用从该比特流中解码出的头信息，解码器就产生一个预測块PRED，它和编码器中的原始PRED是同样的。当该解码器产生的PRED与残差D’n相加后，就得到了uF’n，再经滤波后，最后就得到滤波后的解码输出图像F’n</p>

<h5 id="h264中的i帧p帧和b帧">H264中的I帧、P帧和B帧</h5>
<p>正如上文所说;H264除了使用帧内压缩之外，还使用了帧间压缩；H264采用了独特的I帧、P帧和B帧策略来实现，连续帧之间的压缩；</p>

<p><img src="http://wangpengcheng.github.io/img/x264-ibp.png" alt="I帧、P帧和B帧结构"></p>

<p>如上图所示；</p>

<ul>
  <li>I帧:自身可以通过视频解压算法解压成一张单独的完整的图片。</li>
  <li>P帧:需要参考前面的I帧或P帧,还原成完整的图片。</li>
  <li>B帧:需要同时参考前面和后面的I帧或P帧,来实现图片的还原。
H.264基准类中，仅使用I帧和P帧以实现低延时，因此是网络摄像机和视频编码器的理想选择。
注意：每当读取到一个新的I帧时，解码器会更新残差信息，删除之前的东西，防止错误。</li>
</ul>

<h4 id="h264编码结构解析">H264编码结构解析</h4>

<p>H264除了实现了对视频的压缩处理之外，为了方便网络传输，提供了对应的视频编码和分片策略；类似于网络数据封装成IP帧，在H264中将其称为组(gop)、片（slice）、宏块（Macroblock）这些一起组成了H264的码流分层结构;H264将其组织成为序列(GOP)、图片(pictrue)、片(Slice)、宏块(Macroblock)、子块(subblock)五个层次。</p>

<p><img src="https://gitee.com/kevin1993175/image_resource/raw/master/h264_layer.png" alt="H264 码流分层结构"></p>

<p>H264将视频分为连续的帧进行传输，在连续的帧之间使用I帧、P帧和B帧。同时对于帧内而言，将图像分块为片、宏块和字块进行分片传输；通过这个过程实现对视频文件的压缩包装。</p>

<p><img src="http://upload-images.jianshu.io/upload_images/5956443-5bc8363c14efe8ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Gop、帧对应方式"></p>

<p>在进行H264分包策略解析之前，我们需要先来了解一下H264的原始码流结构</p>

<h4 id="h264-网络包">H264 网络包</h4>
<p><em>参考链接：</em> <a href="http://www.iosxxx.com/blog/2017-08-09-%E4%BB%8E%E9%9B%B6%E4%BA%86%E8%A7%A3H264%E7%BB%93%E6%9E%84.html">从零了解H264结构</a>;<a href="https://www.cnblogs.com/mamamia/p/8580097.html">H264码流结构分析</a>;</p>

<p>H264在提出视频分片压缩策略的同时，也提出了网络分包发送策略。其详细分包发送策略如下：</p>

<p><img src="https://upload-images.jianshu.io/upload_images/1863456-905c7b5515a1fee8.png?imageMogr2/auto-orient/" alt="H264码流分层结构"></p>

<p>下面我们从网络分包的角度对H264原始码流进行分析；</p>

<p>H.264原始码流(裸流)是由一个接一个NALU组成，它的功能分为两层，VCL(视频编码层)和 NAL(网络提取层)；</p>

<ol>
  <li>VCL：包括核心压缩引擎和块，宏块和片的语法级别定义，设计目标是尽可能地独立于网络进行高效的编码；</li>
  <li>NAL：负责将VCL产生的比特字符串适配到各种各样的网络和多元环境中，覆盖了所有片级以上的语法级别。</li>
</ol>

<p>在VCL进行数据传输或存储之前，这些编码的VCL数据，被映射或封装进NAL单元。（NALU）</p>
<blockquote>
  <p>一个NALU = 一组对应于视频编码的NALU头部信息 + 一个原始字节序列负荷(RBSP,Raw Byte Sequence Payload).</p>
</blockquote>

<p>NALU结构单元的主体结构如下所示；一个原始的H.264 NALU单元常由<code class="language-plaintext highlighter-rouge">[StartCode] [NALU Header] [NALU Payload]</code>三部分组成，其中 <code class="language-plaintext highlighter-rouge">Start Code</code> 用于标示这是一个<code class="language-plaintext highlighter-rouge">NALU</code> 单元的开始，必须是”00 00 00 01” 或”00 00 01”，除此之外基本相当于<code class="language-plaintext highlighter-rouge">一个NAL header + RBSP</code>;</p>

<p><img src="http://wangpengcheng.github.io/img/05.png" alt="NALU结构"></p>

<h5 id="nal-header">NAL Header</h5>
<p>由三部分组成，forbidden_bit(1bit)，nal_reference_bit(2bits)（优先级），nal_unit_type(5bits)（类型）</p>

<p><img src="http://wangpengcheng.github.io/img/08.png" alt="NAL Header参数详解表"></p>

<p><img src="https://upload-images.jianshu.io/upload_images/1073278-d8ef546dfd2e8b51.png?imageMogr2/auto-orient/" alt="H264中的码流单位1"></p>

<p><img src="https://upload-images.jianshu.io/upload_images/1073278-48daf0a835c373e4.png?imageMogr2/auto-orient/" alt="H264中的码流单位2"></p>

<p>举例如下：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>00 00 00 01 06:  SEI信息   
00 00 00 01 67:  0x67&amp;0x1f = 0x07 :SPS
00 00 00 01 68:  0x68&amp;0x1f = 0x08 :PPS
00 00 00 01 65:  0x65&amp;0x1f = 0x05: IDR Slice

</code></pre></div></div>

<h4 id="nal解码流程如下图">NAL解码流程如下图</h4>

<p><img src="http://img.blog.csdn.net/20140720115357036?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmNob25nXzIxOQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="NALU解码流程图">;</p>

<h5 id="rbsp">RBSP</h5>
<p>NALU主体为RBSP；RBSP的主要结构如下：</p>

<p><img src="http://wangpengcheng.github.io/img/09.jpg" alt="RBSP主要结构单元"></p>

<p><img src="http://wangpengcheng.github.io/img/10.jpg" alt="RBSP结构说明"></p>

<p>注意：SODB是RBSP的原始帧</p>

<ul>
  <li>SODB 数据比特串 -&gt; 是编码后的原始数据</li>
  <li>RBSP 原始字节序列载荷 -&gt; 在原始编码数据的后面添加了 结尾比特。一个 bit“1”若干比特“0”，以便字节对齐。
<img src="http://wangpengcheng.github.io/img/12.png" alt="RBSP">
    <h5 id="再解h264中的分包策略">再解H264中的分包策略</h5>
  </li>
</ul>

<p>正如图3所示，NALU主体中包含了片头和片上数据</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
1帧 = n个片
1片 = n个宏块
1宏块 = 16x16yuv数据

</code></pre></div></div>
<p>片是H.264提出的新概念，通过编码图片后切分通过高效的方式整合出来的概念。一张图片有一个或者多个片，而片由NALU装载并进行网络传输的。但是NALU不一定是切片，这是充分不必要条件，因为 NALU 还有可能装载着其他用作描述视频的信息;片的种类如下表所示</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">片</th>
      <th style="text-align: center">意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">I 片</td>
      <td style="text-align: center">只包含I宏块</td>
    </tr>
    <tr>
      <td style="text-align: center">P 片</td>
      <td style="text-align: center">包含P和I宏块</td>
    </tr>
    <tr>
      <td style="text-align: center">B 片</td>
      <td style="text-align: center">包含B和I宏块</td>
    </tr>
    <tr>
      <td style="text-align: center">SP 片</td>
      <td style="text-align: center">包含P 和/或 I宏块,用于不同码流之间的切换</td>
    </tr>
    <tr>
      <td style="text-align: center">SI 片</td>
      <td style="text-align: center">一种特殊类型的编码宏块</td>
    </tr>
  </tbody>
</table>

<p>宏块是视频信息的主要承载者。一个编码图像通常划分为多个宏块组成.包含着每一个像素的亮度和色度信息。视频解码最主要的工作则是提供高效的方式从码流中获得宏块中像素阵列。</p>

<blockquote>
  <p>一个宏块 = 一个16*16的亮度像素 + 一个8×8Cb + 一个8×8Cr彩色像素块组成。(YCbCr 是属于 YUV 家族的一员,在YCbCr 中 Y 是指亮度分量，Cb 指蓝色色度分量，而 Cr 指红色色度分量)</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th style="text-align: center">宏块分类</th>
      <th style="text-align: center">意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">I 宏块</td>
      <td style="text-align: center">利用从当前片中已解码的像素作为参考进行帧内预测</td>
    </tr>
    <tr>
      <td style="text-align: center">P 宏块</td>
      <td style="text-align: center">利用前面已编码图像作为参考进行帧内预测，一个帧内编码的宏块可进一步作宏块的分割:即16×16.16×8.8×16.8×8亮度像素块。如果选了8×8的子宏块，则可再分成各种子宏块的分割，其尺寸为8×8，8×4，4×8，4×4</td>
    </tr>
    <tr>
      <td style="text-align: center">B 宏块</td>
      <td style="text-align: center">利用双向的参考图像(当前和未来的已编码图像帧)进行帧内预测</td>
    </tr>
  </tbody>
</table>

<p>句法元素的分层结构有助于更有效地节省码流。例如，再一个图像中，经常会在各个片之间有相同的数据，如果每个片都同时携带这些数据，势必会造成码流的浪费。更为有效的做法是将该图像的公共信息抽取出来，形成图像一级的句法元素，而在片级只携带该片自身独有的句法元素。</p>

<p><img src="http://www.iosxxx.com/images/h264base/07.png" alt="片的结构"></p>

<p><img src="http://www.iosxxx.com/images/h264base/11.png" alt="块的结构"></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">宏块分类</th>
      <th style="text-align: center">意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">mb_type</td>
      <td style="text-align: center">确定该 MB 是帧内或帧间(P 或 B)编码模式，确定该 MB 分割的尺寸</td>
    </tr>
    <tr>
      <td style="text-align: center">mb_pred</td>
      <td style="text-align: center">确定帧内预测模式(帧内宏块)确定表 0 或表 1 参考图 像，和每一宏块分割的差分编码的运动矢量(帧间宏块，除 8×8 宏块分割的帧内 MB)</td>
    </tr>
    <tr>
      <td style="text-align: center">sub_mb_pred</td>
      <td style="text-align: center">(只对 8×8MB 分割的帧内 MB)确定每一子宏块的子宏 块分割，每一宏块分割的表 0 和/或表 1 的参考图象;每一 宏块子分割的差分编码运动矢量。</td>
    </tr>
    <tr>
      <td style="text-align: center">coded_block_pattern</td>
      <td style="text-align: center">指出哪个 8×8 块(亮度和彩色)包 编码变换系数</td>
    </tr>
    <tr>
      <td style="text-align: center">mb_qp_delta</td>
      <td style="text-align: center">量化参数的改变值</td>
    </tr>
    <tr>
      <td style="text-align: center">residual</td>
      <td style="text-align: center">预测后对应于残差图象取样的编码变换系数</td>
    </tr>
  </tbody>
</table>

<h5 id="ipb帧与ptsdts">I,P,B帧与pts/dts</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">帧的分类</th>
      <th style="text-align: center">中文</th>
      <th style="text-align: center">意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">I帧</td>
      <td style="text-align: center">帧内编码帧,又称intra picture</td>
      <td style="text-align: center">I 帧通常是每个 GOP（MPEG 所使用的一种视频压缩技术）的第一个帧，经过适度地压缩，做为随机访问的参考点，可以当成图象。I帧可以看成是一个图像经过压缩后的产物</td>
    </tr>
    <tr>
      <td style="text-align: center">P帧</td>
      <td style="text-align: center">前向预测编码帧,又称predictive-frame</td>
      <td style="text-align: center">通过充分将低于图像序列中前面已编码帧的时间冗余信息来压缩传输数据量的编码图像，也叫预测帧</td>
    </tr>
    <tr>
      <td style="text-align: center">B帧</td>
      <td style="text-align: center">双向预测帧,又称bi-directional interpolated prediction frame</td>
      <td style="text-align: center">既考虑与源图像序列前面已编码帧，也顾及源图像序列后面已编码帧之间的时间冗余信息来压缩传输数据量的编码图像,也叫双向预测帧</td>
    </tr>
  </tbody>
</table>

<p><strong>I,P,B帧的不同</strong></p>

<ul>
  <li>I frame:自身可以通过视频解压算法解压成一张单独的完整的图片。</li>
  <li>P frame：需要参考其前面的一个I frame 或者B frame来生成一张完整的图片。</li>
  <li>B frame:则要参考其前一个I或者P帧及其后面的一个P帧来生成一张完整的图片。</li>
</ul>

<p><strong>pts/dts</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">PTS(Presentation Time Stamp)</td>
      <td style="text-align: center">PTS主要用于度量解码后的视频帧什么时候被显示出来。</td>
    </tr>
    <tr>
      <td style="text-align: center">DTS(Decode Time Stamp)</td>
      <td style="text-align: center">DTS主要是标识内存中的bit流再什么时候开始送入解码器中进行解码。</td>
    </tr>
  </tbody>
</table>

<p><img src="https://gitee.com/kevin1993175/image_resource/raw/master/pts_dts.png" alt="区别图像"></p>

<p>主要区别：DTS主要用户视频的解码，在解码阶段使用。PTS主要用于视频的同步和输出，在display的时候使用。再没有B frame的时候输出顺序一样。</p>

<p><strong>IDR</strong>
一个序列的第一个图像叫做 IDR 图像（立即刷新图像），IDR 图像都是 I 帧图像。
I和IDR帧都使用帧内预测。I帧不用参考任何帧，但是之后的P帧和B帧是有可能参考这个I帧之前的帧的。IDR就不允许这样。
其核心作用是，是为了解码的重同步，当解码器解码到 IDR 图像时，立即将参考帧队列清空，将已解码的数据全部输出或抛弃，重新查找参数集，开始一个新的序列。这样，如果前一个序列出现重大错误，在这里可以获得重新同步的机会。IDR图像之后的图像永远不会使用IDR之前的图像的数据来解码。</p>

<h5 id="帧frame和场filed">帧（frame）和场（filed）</h5>
<p><em>参考链接：</em> <a href="https://blog.csdn.net/soaringlee_fighting/article/details/78458670">帧编码与场编码的区别分析</a></p>

<p>视频的一场和一帧用来产生一个编码图像，一帧通常是一个完整的图像，当采集视频信号时，如果采用隔行扫描（奇、偶数行），则扫描下来的一帧图像就被分成了两个部分，这每一部分都被称为 [场]，根据次序，分为 [顶场] 和 [底场]。
人眼可察觉到的电视视频图像刷新中的闪烁为 0.02 秒，即当电视系统的帧率低于 50 帧/秒，人眼可感觉得出画面的闪烁。常规如 PAL 制式电视系统帧率为 25 帧/秒、NTSC 制式的则为 30 帧/秒，如果采用逐行扫描将不可避免地在视频刷新时产生闪烁现象。而另一方面如果单纯的提高帧率达到避免闪烁刷新效果，则会增加系统的频带宽度。
隔行扫描中，每一帧包含两个场（top field）和（bottom field），其中每个 field 包含一帧中一半数量的水平线，top field 包含所有奇数线，bottom field 则包含所有偶数线。则在电视显示过程中，电子枪每发射一行隔一行—先发射奇数行13579…（top field）回头再发射2468…（bottom field）利用两次扫描来完成一幅图像，因为视觉的滞留性，我们看到的效果是差不多的。如在 NTSC 视频中 frame 的频率为30次/秒-àfield的频率则为 60 次/秒，大于了人眼可察觉闪烁的频率。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">方式</th>
      <th style="text-align: center">作用域</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">帧编码方式</td>
      <td style="text-align: center">活动量较小或者静止的图像宜采用</td>
    </tr>
    <tr>
      <td style="text-align: center">场编码方式</td>
      <td style="text-align: center">活动量较大的运动图像</td>
    </tr>
  </tbody>
</table>

<p><img src="https://gitee.com/kevin1993175/image_resource/raw/master/frame_filed.png" alt="场编码原理"></p>

<h2 id="h264编解码编程">H264编解码编程</h2>
<p><em>参考链接：</em> <a href="https://blog.csdn.net/leixiaohua1020/article/details/45536607">x264源代码简单分析：概述</a>;
开源的H264编码器有很多，JMVC，T264、X264，这里选择X264，因为网上关于X264源码分析资源很多。X264编码器是一个开源的经过优化的高性能H.264编码器，目前最新的源码在本人的I5处理器的PC机上，编码1920x1080分辨率的视频序列在使用ultrafast配置的情况下，可以实现160fps左右的编码速度。
H264编码规范，已经有了不错的编解码实现；其中承担编码任务的主要实现有：x264,解码主要实现有libavcodec；下面分别对这两个进行介绍。</p>

<h3 id="x264说明和api详解">x264说明和API详解</h3>
<h4 id="x264命令行使用和参数解析">x264命令行使用和参数解析</h4>
<p><em>参考链接：</em> <a href="https://www.jianshu.com/p/dea33a9ba070">X264 01 命令行用法</a>
使用linux 中使用x264时可以直接使用：</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x264 <span class="nt">--fullhelp</span> //
</code></pre></div></div>
<p>查看x264帮助信息；显示内容如下</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
x264 core:148 r2643 5c65704
Syntax: x264 <span class="o">[</span>options] <span class="nt">-o</span> outfile infile

Infile can be raw <span class="o">(</span><span class="k">in </span>which <span class="k">case</span> resolution is required<span class="p">)</span>,
  or YUV4MPEG <span class="o">(</span><span class="k">*</span>.y4m<span class="o">)</span>,
  or Avisynth <span class="k">if </span>compiled with support <span class="o">(</span><span class="nb">yes</span><span class="o">)</span><span class="nb">.</span>
  or libav<span class="k">*</span> formats <span class="k">if </span>compiled with lavf support <span class="o">(</span><span class="nb">yes</span><span class="o">)</span> or ffms support <span class="o">(</span><span class="nb">yes</span><span class="o">)</span><span class="nb">.</span>
Outfile <span class="nb">type </span>is selected by filename:
 .264 -&gt; Raw bytestream
 .mkv -&gt; Matroska
 .flv -&gt; Flash Video
 .mp4 -&gt; MP4 <span class="k">if </span>compiled with GPAC or L-SMASH support <span class="o">(</span>gpac<span class="o">)</span>
Output bit depth: 8 <span class="o">(</span>configured at compile <span class="nb">time</span><span class="o">)</span>

Options:

  <span class="nt">-h</span>, <span class="nt">--help</span>                  List basic options
      <span class="nt">--longhelp</span>              List more options
      <span class="nt">--fullhelp</span>              List all options

Example usage:

      Constant quality mode:
            x264 <span class="nt">--crf</span> 24 <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;

      Two-pass with a bitrate of 1000kbps:
            x264 <span class="nt">--pass</span> 1 <span class="nt">--bitrate</span> 1000 <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;
            x264 <span class="nt">--pass</span> 2 <span class="nt">--bitrate</span> 1000 <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;

      Lossless:
            x264 <span class="nt">--qp</span> 0 <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;

      Maximum PSNR at the cost of speed and visual quality:
            x264 <span class="nt">--preset</span> placebo <span class="nt">--tune</span> psnr <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;

      Constant bitrate at 1000kbps with a 2 second-buffer:
            x264 <span class="nt">--vbv-bufsize</span> 2000 <span class="nt">--bitrate</span> 1000 <span class="nt">-o</span> &lt;output&gt; &lt;input&gt;

Presets:

      <span class="nt">--profile</span> &lt;string&gt;      Force the limits of an H.264 profile
                                  Overrides all settings.
                                  - baseline:
                                    <span class="nt">--no-8x8dct</span> <span class="nt">--bframes</span> 0 <span class="nt">--no-cabac</span>
                                    <span class="nt">--cqm</span> flat <span class="nt">--weightp</span> 0
                                    No interlaced.
                                    No lossless.
                                  - main:
                                    <span class="nt">--no-8x8dct</span> <span class="nt">--cqm</span> flat
                                    No lossless.
                                  - high:
                                    No lossless.
                                  - high10:
                                    No lossless.
                                    Support <span class="k">for </span>bit depth 8-10.
                                  - high422:
                                    No lossless.
                                    Support <span class="k">for </span>bit depth 8-10.
                                    Support <span class="k">for </span>4\:2\:0/4\:2\:2 chroma subsampling.
                                  - high444:
                                    Support <span class="k">for </span>bit depth 8-10.
                                    Support <span class="k">for </span>4\:2\:0/4\:2\:2/4\:4\:4 chroma subsampling.
      <span class="nt">--preset</span> &lt;string&gt;       Use a preset to <span class="k">select </span>encoding settings <span class="o">[</span>medium]
                                  Overridden by user settings.
                                  - ultrafast:
                                    <span class="nt">--no-8x8dct</span> <span class="nt">--aq-mode</span> 0 <span class="nt">--b-adapt</span> 0
                                    <span class="nt">--bframes</span> 0 <span class="nt">--no-cabac</span> <span class="nt">--no-deblock</span>
                                    <span class="nt">--no-mbtree</span> <span class="nt">--me</span> dia <span class="nt">--no-mixed-refs</span>
                                    <span class="nt">--partitions</span> none <span class="nt">--rc-lookahead</span> 0 <span class="nt">--ref</span> 1
                                    <span class="nt">--scenecut</span> 0 <span class="nt">--subme</span> 0 <span class="nt">--trellis</span> 0
                                    <span class="nt">--no-weightb</span> <span class="nt">--weightp</span> 0
                                  - superfast:
                                    <span class="nt">--no-mbtree</span> <span class="nt">--me</span> dia <span class="nt">--no-mixed-refs</span>
                                    <span class="nt">--partitions</span> i8x8,i4x4 <span class="nt">--rc-lookahead</span> 0
                                    <span class="nt">--ref</span> 1 <span class="nt">--subme</span> 1 <span class="nt">--trellis</span> 0 <span class="nt">--weightp</span> 1
                                  - veryfast:
                                    <span class="nt">--no-mixed-refs</span> <span class="nt">--rc-lookahead</span> 10
                                    <span class="nt">--ref</span> 1 <span class="nt">--subme</span> 2 <span class="nt">--trellis</span> 0 <span class="nt">--weightp</span> 1
                                  - faster:
                                    <span class="nt">--no-mixed-refs</span> <span class="nt">--rc-lookahead</span> 20
                                    <span class="nt">--ref</span> 2 <span class="nt">--subme</span> 4 <span class="nt">--weightp</span> 1
                                  - fast:
                                    <span class="nt">--rc-lookahead</span> 30 <span class="nt">--ref</span> 2 <span class="nt">--subme</span> 6
                                    <span class="nt">--weightp</span> 1
                                  - medium:
                                    Default settings apply.
                                  - slow:
                                    <span class="nt">--b-adapt</span> 2 <span class="nt">--direct</span> auto <span class="nt">--me</span> umh
                                    <span class="nt">--rc-lookahead</span> 50 <span class="nt">--ref</span> 5 <span class="nt">--subme</span> 8
                                  - slower:
                                    <span class="nt">--b-adapt</span> 2 <span class="nt">--direct</span> auto <span class="nt">--me</span> umh
                                    <span class="nt">--partitions</span> all <span class="nt">--rc-lookahead</span> 60
                                    <span class="nt">--ref</span> 8 <span class="nt">--subme</span> 9 <span class="nt">--trellis</span> 2
                                  - veryslow:
                                    <span class="nt">--b-adapt</span> 2 <span class="nt">--bframes</span> 8 <span class="nt">--direct</span> auto
                                    <span class="nt">--me</span> umh <span class="nt">--merange</span> 24 <span class="nt">--partitions</span> all
                                    <span class="nt">--ref</span> 16 <span class="nt">--subme</span> 10 <span class="nt">--trellis</span> 2
                                    <span class="nt">--rc-lookahead</span> 60
                                  - placebo:
                                    <span class="nt">--bframes</span> 16 <span class="nt">--b-adapt</span> 2 <span class="nt">--direct</span> auto
                                    <span class="nt">--slow-firstpass</span> <span class="nt">--no-fast-pskip</span>
                                    <span class="nt">--me</span> tesa <span class="nt">--merange</span> 24 <span class="nt">--partitions</span> all
                                    <span class="nt">--rc-lookahead</span> 60 <span class="nt">--ref</span> 16 <span class="nt">--subme</span> 11
                                    <span class="nt">--trellis</span> 2
      <span class="nt">--tune</span> &lt;string&gt;         Tune the settings <span class="k">for </span>a particular <span class="nb">type </span>of <span class="nb">source
                              </span>or situation
                                  Overridden by user settings.
                                  Multiple tunings are separated by commas.
                                  Only one psy tuning can be used at a time.
                                  - film <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--deblock</span> <span class="nt">-1</span>:-1 <span class="nt">--psy-rd</span> &lt;<span class="nb">unset</span><span class="o">&gt;</span>:0.15
                                  - animation <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--bframes</span> <span class="o">{</span>+2<span class="o">}</span> <span class="nt">--deblock</span> 1:1
                                    <span class="nt">--psy-rd</span> 0.4:&lt;<span class="nb">unset</span><span class="o">&gt;</span> <span class="nt">--aq-strength</span> 0.6
                                    <span class="nt">--ref</span> <span class="o">{</span>Double <span class="k">if</span> <span class="o">&gt;</span>1 <span class="k">else </span>1<span class="o">}</span>
                                  - grain <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--aq-strength</span> 0.5 <span class="nt">--no-dct-decimate</span>
                                    <span class="nt">--deadzone-inter</span> 6 <span class="nt">--deadzone-intra</span> 6
                                    <span class="nt">--deblock</span> <span class="nt">-2</span>:-2 <span class="nt">--ipratio</span> 1.1 
                                    <span class="nt">--pbratio</span> 1.1 <span class="nt">--psy-rd</span> &lt;<span class="nb">unset</span><span class="o">&gt;</span>:0.25
                                    <span class="nt">--qcomp</span> 0.8
                                  - stillimage <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--aq-strength</span> 1.2 <span class="nt">--deblock</span> <span class="nt">-3</span>:-3
                                    <span class="nt">--psy-rd</span> 2.0:0.7
                                  - psnr <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--aq-mode</span> 0 <span class="nt">--no-psy</span>
                                  - ssim <span class="o">(</span>psy tuning<span class="o">)</span>:
                                    <span class="nt">--aq-mode</span> 2 <span class="nt">--no-psy</span>
                                  - fastdecode:
                                    <span class="nt">--no-cabac</span> <span class="nt">--no-deblock</span> <span class="nt">--no-weightb</span>
                                    <span class="nt">--weightp</span> 0
                                  - zerolatency:
                                    <span class="nt">--bframes</span> 0 <span class="nt">--force-cfr</span> <span class="nt">--no-mbtree</span>
                                    <span class="nt">--sync-lookahead</span> 0 <span class="nt">--sliced-threads</span>
                                    <span class="nt">--rc-lookahead</span> 0
      <span class="nt">--slow-firstpass</span>        Do not force these faster settings with <span class="nt">--pass</span> 1:
                                  <span class="nt">--no-8x8dct</span> <span class="nt">--me</span> dia <span class="nt">--partitions</span> none
                                  <span class="nt">--ref</span> 1 <span class="nt">--subme</span> <span class="o">{</span>2 <span class="k">if</span> <span class="o">&gt;</span>2 <span class="k">else </span>unchanged<span class="o">}</span>
                                  <span class="nt">--trellis</span> 0 <span class="nt">--fast-pskip</span>

Frame-type options:

  <span class="nt">-I</span>, <span class="nt">--keyint</span> &lt;integer or <span class="s2">"infinite"</span><span class="o">&gt;</span> Maximum GOP size <span class="o">[</span>250]
  <span class="nt">-i</span>, <span class="nt">--min-keyint</span> &lt;integer&gt;  Minimum GOP size <span class="o">[</span>auto]
      <span class="nt">--no-scenecut</span>           Disable adaptive I-frame decision
      <span class="nt">--scenecut</span> &lt;integer&gt;    How aggressively to insert extra I-frames <span class="o">[</span>40]
      <span class="nt">--intra-refresh</span>         Use Periodic Intra Refresh instead of IDR frames
  <span class="nt">-b</span>, <span class="nt">--bframes</span> &lt;integer&gt;     Number of B-frames between I and P <span class="o">[</span>3]
      <span class="nt">--b-adapt</span> &lt;integer&gt;     Adaptive B-frame decision method <span class="o">[</span>1]
                                  Higher values may lower threading efficiency.
                                  - 0: Disabled
                                  - 1: Fast
                                  - 2: Optimal <span class="o">(</span>slow with high <span class="nt">--bframes</span><span class="o">)</span>
      <span class="nt">--b-bias</span> &lt;integer&gt;      Influences how often B-frames are used <span class="o">[</span>0]
      <span class="nt">--b-pyramid</span> &lt;string&gt;    Keep some B-frames as references <span class="o">[</span>normal]
                                  - none: Disabled
                                  - strict: Strictly hierarchical pyramid
                                  - normal: Non-strict <span class="o">(</span>not Blu-ray compatible<span class="o">)</span>
      <span class="nt">--open-gop</span>              Use recovery points to close GOPs
                              Only available with b-frames
      <span class="nt">--no-cabac</span>              Disable CABAC
  <span class="nt">-r</span>, <span class="nt">--ref</span> &lt;integer&gt;         Number of reference frames <span class="o">[</span>3]
      <span class="nt">--no-deblock</span>            Disable loop filter
  <span class="nt">-f</span>, <span class="nt">--deblock</span> &lt;alpha:beta&gt;  Loop filter parameters <span class="o">[</span>0:0]
      <span class="nt">--slices</span> &lt;integer&gt;      Number of slices per frame<span class="p">;</span> forces rectangular
                              slices and is overridden by other slicing options
      <span class="nt">--slices-max</span> &lt;integer&gt;  Absolute maximum slices per frame<span class="p">;</span> overrides
                              slice-max-size/slice-max-mbs when necessary
      <span class="nt">--slice-max-size</span> &lt;integer&gt; Limit the size of each slice <span class="k">in </span>bytes
      <span class="nt">--slice-max-mbs</span> &lt;integer&gt; Limit the size of each slice <span class="k">in </span>macroblocks <span class="o">(</span>max<span class="o">)</span>
      <span class="nt">--slice-min-mbs</span> &lt;integer&gt; Limit the size of each slice <span class="k">in </span>macroblocks <span class="o">(</span>min<span class="o">)</span>
      <span class="nt">--tff</span>                   Enable interlaced mode <span class="o">(</span>top field first<span class="o">)</span>
      <span class="nt">--bff</span>                   Enable interlaced mode <span class="o">(</span>bottom field first<span class="o">)</span>
      <span class="nt">--constrained-intra</span>     Enable constrained intra prediction.
      <span class="nt">--pulldown</span> &lt;string&gt;     Use soft pulldown to change frame rate
                                  - none, 22, 32, 64, double, triple, euro <span class="o">(</span>requires cfr input<span class="o">)</span>
      <span class="nt">--fake-interlaced</span>       Flag stream as interlaced but encode progressive.
                              Makes it possible to encode 25p and 30p Blu-Ray
                              streams. Ignored <span class="k">in </span>interlaced mode.
      <span class="nt">--frame-packing</span> &lt;integer&gt; For stereoscopic videos define frame arrangement
                                  - 0: checkerboard - pixels are alternatively from L and R
                                  - 1: column alternation - L and R are interlaced by column
                                  - 2: row alternation - L and R are interlaced by row
                                  - 3: side by side - L is on the left, R on the right
                                  - 4: top bottom - L is on top, R on bottom
                                  - 5: frame alternation - one view per frame
                                  - 6: mono - 2D frame without any frame packing
                                  - 7: tile format - L is on top-left, R <span class="nb">split </span>across

Ratecontrol:

  <span class="nt">-q</span>, <span class="nt">--qp</span> &lt;integer&gt;          Force constant QP <span class="o">(</span>0-69, <span class="nv">0</span><span class="o">=</span>lossless<span class="o">)</span>
  <span class="nt">-B</span>, <span class="nt">--bitrate</span> &lt;integer&gt;     Set bitrate <span class="o">(</span>kbit/s<span class="o">)</span>
      <span class="nt">--crf</span> &lt;float&gt;           Quality-based VBR <span class="o">(</span>0-51<span class="o">)</span> <span class="o">[</span>23.0]
      <span class="nt">--rc-lookahead</span> &lt;integer&gt; Number of frames <span class="k">for </span>frametype lookahead <span class="o">[</span>40]
      <span class="nt">--vbv-maxrate</span> &lt;integer&gt; Max <span class="nb">local </span>bitrate <span class="o">(</span>kbit/s<span class="o">)</span> <span class="o">[</span>0]
      <span class="nt">--vbv-bufsize</span> &lt;integer&gt; Set size of the VBV buffer <span class="o">(</span>kbit<span class="o">)</span> <span class="o">[</span>0]
      <span class="nt">--vbv-init</span> &lt;float&gt;      Initial VBV buffer occupancy <span class="o">[</span>0.9]
      <span class="nt">--crf-max</span> &lt;float&gt;       With CRF+VBV, limit RF to this value
                                  May cause VBV underflows!
      <span class="nt">--qpmin</span> &lt;integer&gt;       Set min QP <span class="o">[</span>0]
      <span class="nt">--qpmax</span> &lt;integer&gt;       Set max QP <span class="o">[</span>69]
      <span class="nt">--qpstep</span> &lt;integer&gt;      Set max QP step <span class="o">[</span>4]
      <span class="nt">--ratetol</span> &lt;float&gt;       Tolerance of ABR ratecontrol and VBV <span class="o">[</span>1.0]
      <span class="nt">--ipratio</span> &lt;float&gt;       QP <span class="nb">factor </span>between I and P <span class="o">[</span>1.40]
      <span class="nt">--pbratio</span> &lt;float&gt;       QP <span class="nb">factor </span>between P and B <span class="o">[</span>1.30]
      <span class="nt">--chroma-qp-offset</span> &lt;integer&gt;  QP difference between chroma and luma <span class="o">[</span>0]
      <span class="nt">--aq-mode</span> &lt;integer&gt;     AQ method <span class="o">[</span>1]
                                  - 0: Disabled
                                  - 1: Variance AQ <span class="o">(</span>complexity mask<span class="o">)</span>
                                  - 2: Auto-variance AQ
                                  - 3: Auto-variance AQ with bias to dark scenes
      <span class="nt">--aq-strength</span> &lt;float&gt;   Reduces blocking and blurring <span class="k">in </span>flat and
                              textured areas. <span class="o">[</span>1.0]

  <span class="nt">-p</span>, <span class="nt">--pass</span> &lt;integer&gt;        Enable multipass ratecontrol
                                  - 1: First pass, creates stats file
                                  - 2: Last pass, does not overwrite stats file
                                  - 3: Nth pass, overwrites stats file
      <span class="nt">--stats</span> &lt;string&gt;        Filename <span class="k">for </span>2 pass stats <span class="o">[</span><span class="s2">"x264_2pass.log"</span><span class="o">]</span>
      <span class="nt">--no-mbtree</span>             Disable mb-tree ratecontrol.
      <span class="nt">--qcomp</span> &lt;float&gt;         QP curve compression <span class="o">[</span>0.60]
      <span class="nt">--cplxblur</span> &lt;float&gt;      Reduce fluctuations <span class="k">in </span>QP <span class="o">(</span>before curve compression<span class="o">)</span> <span class="o">[</span>20.0]
      <span class="nt">--qblur</span> &lt;float&gt;         Reduce fluctuations <span class="k">in </span>QP <span class="o">(</span>after curve compression<span class="o">)</span> <span class="o">[</span>0.5]
      <span class="nt">--zones</span> &lt;zone0&gt;/&lt;zone1&gt;/...  Tweak the bitrate of regions of the video
                              Each zone is of the form
                                  &lt;start frame&gt;,&lt;end frame&gt;,&lt;option&gt;
                                  where &lt;option&gt; is either
                                      <span class="nv">q</span><span class="o">=</span>&lt;integer&gt; <span class="o">(</span>force QP<span class="o">)</span>
                                  or  <span class="nv">b</span><span class="o">=</span>&lt;float&gt; <span class="o">(</span>bitrate multiplier<span class="o">)</span>
      <span class="nt">--qpfile</span> &lt;string&gt;       Force frametypes and QPs <span class="k">for </span>some or all frames
                              Format of each line: framenumber frametype QP
                              QP is optional <span class="o">(</span>none lets x264 choose<span class="o">)</span><span class="nb">.</span> Frametypes: I,i,K,P,B,b.
                                  <span class="nv">K</span><span class="o">=</span>&lt;I or i&gt; depending on open-gop setting
                              QPs are restricted by qpmin/qpmax.

Analysis:

  <span class="nt">-A</span>, <span class="nt">--partitions</span> &lt;string&gt;   Partitions to consider <span class="o">[</span><span class="s2">"p8x8,b8x8,i8x8,i4x4"</span><span class="o">]</span>
                                  - p8x8, p4x4, b8x8, i8x8, i4x4
                                  - none, all
                                  <span class="o">(</span>p4x4 requires p8x8. i8x8 requires <span class="nt">--8x8dct</span>.<span class="o">)</span>
      <span class="nt">--direct</span> &lt;string&gt;       Direct MV prediction mode <span class="o">[</span><span class="s2">"spatial"</span><span class="o">]</span>
                                  - none, spatial, temporal, auto
      <span class="nt">--no-weightb</span>            Disable weighted prediction <span class="k">for </span>B-frames
      <span class="nt">--weightp</span> &lt;integer&gt;     Weighted prediction <span class="k">for </span>P-frames <span class="o">[</span>2]
                                  - 0: Disabled
                                  - 1: Weighted refs
                                  - 2: Weighted refs + Duplicates
      <span class="nt">--me</span> &lt;string&gt;           Integer pixel motion estimation method <span class="o">[</span><span class="s2">"hex"</span><span class="o">]</span>
                                  - dia: diamond search, radius 1 <span class="o">(</span>fast<span class="o">)</span>
                                  - hex: hexagonal search, radius 2
                                  - umh: uneven multi-hexagon search
                                  - esa: exhaustive search
                                  - tesa: hadamard exhaustive search <span class="o">(</span>slow<span class="o">)</span>
      <span class="nt">--merange</span> &lt;integer&gt;     Maximum motion vector search range <span class="o">[</span>16]
      <span class="nt">--mvrange</span> &lt;integer&gt;     Maximum motion vector length <span class="o">[</span><span class="nt">-1</span> <span class="o">(</span>auto<span class="o">)]</span>
      <span class="nt">--mvrange-thread</span> &lt;int&gt;  Minimum buffer between threads <span class="o">[</span><span class="nt">-1</span> <span class="o">(</span>auto<span class="o">)]</span>
  <span class="nt">-m</span>, <span class="nt">--subme</span> &lt;integer&gt;       Subpixel motion estimation and mode decision <span class="o">[</span>7]
                                  - 0: fullpel only <span class="o">(</span>not recommended<span class="o">)</span>
                                  - 1: SAD mode decision, one qpel iteration
                                  - 2: SATD mode decision
                                  - 3-5: Progressively more qpel
                                  - 6: RD mode decision <span class="k">for </span>I/P-frames
                                  - 7: RD mode decision <span class="k">for </span>all frames
                                  - 8: RD refinement <span class="k">for </span>I/P-frames
                                  - 9: RD refinement <span class="k">for </span>all frames
                                  - 10: QP-RD - requires <span class="nv">trellis</span><span class="o">=</span>2, aq-mode&gt;0
                                  - 11: Full RD: disable all early terminations
      <span class="nt">--psy-rd</span> &lt;float:float&gt;  Strength of psychovisual optimization <span class="o">[</span><span class="s2">"1.0:0.0"</span><span class="o">]</span>
                                  <span class="c">#1: RD (requires subme&gt;=6)</span>
                                  <span class="c">#2: Trellis (requires trellis, experimental)</span>
      <span class="nt">--no-psy</span>                Disable all visual optimizations that worsen
                              both PSNR and SSIM.
      <span class="nt">--no-mixed-refs</span>         Do not decide references on a per partition basis
      <span class="nt">--no-chroma-me</span>          Ignore chroma <span class="k">in </span>motion estimation
      <span class="nt">--no-8x8dct</span>             Disable adaptive spatial transform size
  <span class="nt">-t</span>, <span class="nt">--trellis</span> &lt;integer&gt;     Trellis RD quantization. <span class="o">[</span>1]
                                  - 0: disabled
                                  - 1: enabled only on the final encode of a MB
                                  - 2: enabled on all mode decisions
      <span class="nt">--no-fast-pskip</span>         Disables early SKIP detection on P-frames
      <span class="nt">--no-dct-decimate</span>       Disables coefficient thresholding on P-frames
      <span class="nt">--nr</span> &lt;integer&gt;          Noise reduction <span class="o">[</span>0]

      <span class="nt">--deadzone-inter</span> &lt;int&gt;  Set the size of the inter luma quantization deadzone <span class="o">[</span>21]
      <span class="nt">--deadzone-intra</span> &lt;int&gt;  Set the size of the intra luma quantization deadzone <span class="o">[</span>11]
                                  Deadzones should be <span class="k">in </span>the range 0 - 32.
      <span class="nt">--cqm</span> &lt;string&gt;          Preset quant matrices <span class="o">[</span><span class="s2">"flat"</span><span class="o">]</span>
                                  - jvt, flat
      <span class="nt">--cqmfile</span> &lt;string&gt;      Read custom quant matrices from a JM-compatible file
                                  Overrides any other <span class="nt">--cqm</span><span class="k">*</span> options.
      <span class="nt">--cqm4</span> &lt;list&gt;           Set all 4x4 quant matrices
                                  Takes a comma-separated list of 16 integers.
      <span class="nt">--cqm8</span> &lt;list&gt;           Set all 8x8 quant matrices
                                  Takes a comma-separated list of 64 integers.
      <span class="nt">--cqm4i</span>, <span class="nt">--cqm4p</span>, <span class="nt">--cqm8i</span>, <span class="nt">--cqm8p</span> &lt;list&gt;
                              Set both luma and chroma quant matrices
      <span class="nt">--cqm4iy</span>, <span class="nt">--cqm4ic</span>, <span class="nt">--cqm4py</span>, <span class="nt">--cqm4pc</span> &lt;list&gt;
                              Set individual quant matrices

Video Usability Info <span class="o">(</span>Annex E<span class="o">)</span>:
The VUI settings are not used by the encoder but are merely suggestions to
the playback equipment. See doc/vui.txt <span class="k">for </span>details. Use at your own risk.

      <span class="nt">--overscan</span> &lt;string&gt;     Specify crop overscan setting <span class="o">[</span><span class="s2">"undef"</span><span class="o">]</span>
                                  - undef, show, crop
      <span class="nt">--videoformat</span> &lt;string&gt;  Specify video format <span class="o">[</span><span class="s2">"undef"</span><span class="o">]</span>
                                  - component, pal, ntsc, secam, mac, undef
      <span class="nt">--range</span> &lt;string&gt;        Specify color range <span class="o">[</span><span class="s2">"auto"</span><span class="o">]</span>
                                  - auto, tv, pc
      <span class="nt">--colorprim</span> &lt;string&gt;    Specify color primaries <span class="o">[</span><span class="s2">"undef"</span><span class="o">]</span>
                                  - undef, bt709, bt470m, bt470bg, smpte170m,
                                    smpte240m, film, bt2020
      <span class="nt">--transfer</span> &lt;string&gt;     Specify transfer characteristics <span class="o">[</span><span class="s2">"undef"</span><span class="o">]</span>
                                  - undef, bt709, bt470m, bt470bg, smpte170m,
                                    smpte240m, linear, log100, log316,
                                    iec61966-2-4, bt1361e, iec61966-2-1,
                                    bt2020-10, bt2020-12
      <span class="nt">--colormatrix</span> &lt;string&gt;  Specify color matrix setting <span class="o">[</span><span class="s2">"???"</span><span class="o">]</span>
                                  - undef, bt709, fcc, bt470bg, smpte170m,
                                    smpte240m, GBR, YCgCo, bt2020nc, bt2020c
      <span class="nt">--chromaloc</span> &lt;integer&gt;   Specify chroma sample location <span class="o">(</span>0 to 5<span class="o">)</span> <span class="o">[</span>0]
      <span class="nt">--nal-hrd</span> &lt;string&gt;      Signal HRD information <span class="o">(</span>requires vbv-bufsize<span class="o">)</span>
                                  - none, vbr, cbr <span class="o">(</span>cbr not allowed <span class="k">in</span> .mp4<span class="o">)</span>
      <span class="nt">--filler</span>                Force hard-CBR and generate filler <span class="o">(</span>implied by
                              <span class="nt">--nal-hrd</span> cbr<span class="o">)</span>
      <span class="nt">--pic-struct</span>            Force pic_struct <span class="k">in </span>Picture Timing SEI
      <span class="nt">--crop-rect</span> &lt;string&gt;    Add <span class="s1">'left,top,right,bottom'</span> to the bitstream-level
                              cropping rectangle

Input/Output:

  <span class="nt">-o</span>, <span class="nt">--output</span> &lt;string&gt;       Specify output file
      <span class="nt">--muxer</span> &lt;string&gt;        Specify output container format <span class="o">[</span><span class="s2">"auto"</span><span class="o">]</span>
                                  - auto, raw, mkv, flv, mp4
      <span class="nt">--demuxer</span> &lt;string&gt;      Specify input container format <span class="o">[</span><span class="s2">"auto"</span><span class="o">]</span>
                                  - auto, raw, y4m, avs, lavf, ffms
      <span class="nt">--input-fmt</span> &lt;string&gt;    Specify input file format <span class="o">(</span>requires lavf support<span class="o">)</span>
      <span class="nt">--input-csp</span> &lt;string&gt;    Specify input colorspace format <span class="k">for </span>raw input
                              - valid csps <span class="k">for</span> <span class="sb">`</span>raw<span class="sb">`</span> demuxer:
                                i420, yv12, nv12, nv21, i422, yv16, nv16, i444, yv24, bgr, bgra, rgb
                              - valid csps <span class="k">for</span> <span class="sb">`</span>lavf<span class="sb">`</span> demuxer:
                                yuv420p, yuyv422, rgb24, bgr24, yuv422p, 
                                yuv444p, yuv410p, yuv411p, gray, monow, monob, 
                                pal8, yuvj420p, yuvj422p, yuvj444p, xvmcmc, 
                                xvmcidct, uyvy422, uyyvyy411, bgr8, bgr4, 
                                bgr4_byte, rgb8, rgb4, rgb4_byte, nv12, nv21, 
                                argb, rgba, abgr, bgra, gray16be, gray16le, 
                                yuv440p, yuvj440p, yuva420p, vdpau_h264, 
                                vdpau_mpeg1, vdpau_mpeg2, vdpau_wmv3, 
                                vdpau_vc1, rgb48be, rgb48le, rgb565be, 
                                rgb565le, rgb555be, rgb555le, bgr565be, 
                                bgr565le, bgr555be, bgr555le, vaapi_moco, 
                                vaapi_idct, vaapi_vld, yuv420p16le, 
                                yuv420p16be, yuv422p16le, yuv422p16be, 
                                yuv444p16le, yuv444p16be, vdpau_mpeg4, 
                                dxva2_vld, rgb444le, rgb444be, bgr444le, 
                                bgr444be, ya8, bgr48be, bgr48le, yuv420p9be, 
                                yuv420p9le, yuv420p10be, yuv420p10le, 
                                yuv422p10be, yuv422p10le, yuv444p9be, 
                                yuv444p9le, yuv444p10be, yuv444p10le, 
                                yuv422p9be, yuv422p9le, vda_vld, gbrp, gbrp9be, 
                                gbrp9le, gbrp10be, gbrp10le, gbrp16be, 
                                gbrp16le, yuva420p9be, yuva420p9le, 
                                yuva422p9be, yuva422p9le, yuva444p9be, 
                                yuva444p9le, yuva420p10be, yuva420p10le, 
                                yuva422p10be, yuva422p10le, yuva444p10be, 
                                yuva444p10le, yuva420p16be, yuva420p16le, 
                                yuva422p16be, yuva422p16le, yuva444p16be, 
                                yuva444p16le, vdpau, xyz12le, xyz12be, nv16, 
                                nv20le, nv20be, yvyu422, vda, ya16be, ya16le, 
                                qsv, mmal, d3d11va_vld, rgba64be, rgba64le, 
                                bgra64be, bgra64le, 0rgb, rgb0, 0bgr, bgr0, 
                                yuva444p, yuva422p, yuv420p12be, yuv420p12le, 
                                yuv420p14be, yuv420p14le, yuv422p12be, 
                                yuv422p12le, yuv422p14be, yuv422p14le, 
                                yuv444p12be, yuv444p12le, yuv444p14be, 
                                yuv444p14le, gbrp12be, gbrp12le, gbrp14be, 
                                gbrp14le, gbrap, gbrap16be, gbrap16le, 
                                yuvj411p, bayer_bggr8, bayer_rggb8, 
                                bayer_gbrg8, bayer_grbg8, bayer_bggr16le, 
                                bayer_bggr16be, bayer_rggb16le, bayer_rggb16be, 
                                bayer_gbrg16le, bayer_gbrg16be, bayer_grbg16le, 
                                bayer_grbg16be, yuv440p10le, yuv440p10be, 
                                yuv440p12le, yuv440p12be, ayuv64le, ayuv64be, 
                                videotoolbox_vld
      <span class="nt">--output-csp</span> &lt;string&gt;   Specify output colorspace <span class="o">[</span><span class="s2">"i420"</span><span class="o">]</span>
                                  - i420, i422, i444, rgb
      <span class="nt">--input-depth</span> &lt;integer&gt; Specify input bit depth <span class="k">for </span>raw input
      <span class="nt">--input-range</span> &lt;string&gt;  Specify input color range <span class="o">[</span><span class="s2">"auto"</span><span class="o">]</span>
                                  - auto, tv, pc
      <span class="nt">--input-res</span> &lt;intxint&gt;   Specify input resolution <span class="o">(</span>width x height<span class="o">)</span>
      <span class="nt">--index</span> &lt;string&gt;        Filename <span class="k">for </span>input index file
      <span class="nt">--sar</span> width:height      Specify Sample Aspect Ratio
      <span class="nt">--fps</span> &lt;float|rational&gt;  Specify framerate
      <span class="nt">--seek</span> &lt;integer&gt;        First frame to encode
      <span class="nt">--frames</span> &lt;integer&gt;      Maximum number of frames to encode
      <span class="nt">--level</span> &lt;string&gt;        Specify level <span class="o">(</span>as defined by Annex A<span class="o">)</span>
      <span class="nt">--bluray-compat</span>         Enable compatibility hacks <span class="k">for </span>Blu-ray support
      <span class="nt">--avcintra-class</span> &lt;integer&gt; Use compatibility hacks <span class="k">for </span>AVC-Intra class
                                  - 50, 100, 200
      <span class="nt">--stitchable</span>            Do not optimize headers based on video content
                              Ensures ability to recombine a segmented encode

  <span class="nt">-v</span>, <span class="nt">--verbose</span>               Print stats <span class="k">for </span>each frame
      <span class="nt">--no-progress</span>           Do not show the progress indicator <span class="k">while </span>encoding
      <span class="nt">--quiet</span>                 Quiet Mode
      <span class="nt">--log-level</span> &lt;string&gt;    Specify the maximum level of logging <span class="o">[</span><span class="s2">"info"</span><span class="o">]</span>
                                  - none, error, warning, info, debug
      <span class="nt">--psnr</span>                  Enable PSNR computation
      <span class="nt">--ssim</span>                  Enable SSIM computation
      <span class="nt">--threads</span> &lt;integer&gt;     Force a specific number of threads
      <span class="nt">--lookahead-threads</span> &lt;integer&gt; Force a specific number of lookahead threads
      <span class="nt">--sliced-threads</span>        Low-latency but lower-efficiency threading
      <span class="nt">--thread-input</span>          Run Avisynth <span class="k">in </span>its own thread
      <span class="nt">--sync-lookahead</span> &lt;integer&gt; Number of buffer frames <span class="k">for </span>threaded lookahead
      <span class="nt">--non-deterministic</span>     Slightly improve quality of SMP, at the cost of repeatability
      <span class="nt">--cpu-independent</span>       Ensure exact reproducibility across different cpus,
                                  as opposed to letting them <span class="k">select </span>different algorithms
      <span class="nt">--asm</span> &lt;integer&gt;         Override CPU detection
      <span class="nt">--no-asm</span>                Disable all CPU optimizations
      <span class="nt">--opencl</span>                Enable use of OpenCL
      <span class="nt">--opencl-clbin</span> &lt;string&gt; Specify path of compiled OpenCL kernel cache
      <span class="nt">--opencl-device</span> &lt;integer&gt; Specify OpenCL device ordinal
      <span class="nt">--dump-yuv</span> &lt;string&gt;     Save reconstructed frames
      <span class="nt">--sps-id</span> &lt;integer&gt;      Set SPS and PPS <span class="nb">id </span>numbers <span class="o">[</span>0]
      <span class="nt">--aud</span>                   Use access unit delimiters
      <span class="nt">--force-cfr</span>             Force constant framerate timestamp generation
      <span class="nt">--tcfile-in</span> &lt;string&gt;    Force timestamp generation with timecode file
      <span class="nt">--tcfile-out</span> &lt;string&gt;   Output timecode v2 file from input timestamps
      <span class="nt">--timebase</span> &lt;int/int&gt;    Specify timebase numerator and denominator
                 &lt;integer&gt;    Specify timebase numerator <span class="k">for </span>input timecode file
                              or specify timebase denominator <span class="k">for </span>other input
      <span class="nt">--dts-compress</span>          Eliminate initial delay with container DTS hack

Filtering:

      <span class="nt">--vf</span>, <span class="nt">--video-filter</span> &lt;filter0&gt;/&lt;filter1&gt;/... Apply video filtering to the input file

      Filter options may be specified <span class="k">in</span> &lt;filter&gt;:&lt;option&gt;<span class="o">=</span>&lt;value&gt; format.

      Available filters:
      crop:left,top,right,bottom
            removes pixels from the edges of the frame
      resize:[width,height][,sar][,fittobox][,csp][,method]
            resizes frames based on the given criteria:
            - resolution only: resizes and adapts sar to avoid stretching
            - sar only: sets the sar and resizes to avoid stretching
            - resolution and sar: resizes to given resolution and sets the sar
            - fittobox: resizes the video based on the desired constraints
               - width, height, both
            - fittobox and sar: same as above except with specified sar
            - csp: convert to the given csp. syntax: <span class="o">[</span>name][:depth]
               - valid csp names <span class="o">[</span>keep current]: i420, yv12, nv12, nv21, i422, yv16, nv16, i444, yv24, bgr, bgra, rgb
               - depth: 8 or 16 bits per pixel <span class="o">[</span>keep current]
            note: not all depths are supported by all csps.
            - method: use resizer method <span class="o">[</span><span class="s2">"bicubic"</span><span class="o">]</span>
               - fastbilinear, bilinear, bicubic, experimental, point,
               - area, bicublin, gauss, sinc, lanczos, spline
      select_every:step,offset1[,...]
            apply a selection pattern to input frames
            step: the number of frames <span class="k">in </span>the pattern
            offsets: the offset into the step to <span class="k">select </span>a frame
            see: http://avisynth.nl/index.php/Select#SelectEvery


</code></pre></div></div>

<h5 id="基本使用方法">基本使用方法：</h5>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x264 <span class="o">[</span>options] <span class="nt">-o</span> outfile infile
<span class="c"># 可以输出为一下四种格式</span>
Outfile <span class="nb">type </span>is selected by filename:
 .264 -&gt; Raw bytestream
 .mkv -&gt; Matroska
 .flv -&gt; Flash Video
 .mp4 -&gt; MP4 <span class="k">if </span>compiled with GPAC or L-SMASH support <span class="o">(</span>no<span class="o">)</span>

</code></pre></div></div>
<p>基本参数说明：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--bitrate </code> :指定码率，使用示例：<code class="language-plaintext highlighter-rouge">x264 --bitrate 1000 -o output.264 input_640x360_yuv420p.yuv</code>;</li>
  <li>
<code class="language-plaintext highlighter-rouge">--fps</code> :指定帧率，使用示例：<code class="language-plaintext highlighter-rouge">x264 --fps 10 -o output.264 input_640x360_yuv420p.yuv</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">--preset</code>：指定编码速度，<code class="language-plaintext highlighter-rouge">--preset</code>的参数主要调节编码速度和质量的平衡;使用示例：<code class="language-plaintext highlighter-rouge">x264 --preset ultrafast -o output.264 input_640x360_yuv420p.yuv</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">--tune</code>:融合视觉优化，tune的值有：
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">film</code>:电影、真人类型</li>
      <li>
<code class="language-plaintext highlighter-rouge">animation</code>:动画</li>
      <li>
<code class="language-plaintext highlighter-rouge">grain</code>:需要保留大量的grain</li>
      <li>
<code class="language-plaintext highlighter-rouge">stillimage</code>:静态图像编码时使用</li>
      <li>
<code class="language-plaintext highlighter-rouge">psnr</code>:为提高psnr做了参数上的优化</li>
      <li>
<code class="language-plaintext highlighter-rouge">ssim</code>:为提高ssim做了优化的参数</li>
      <li>fastecode:可以快速解码的参数</li>
      <li>zerolatency:0延迟，用在需要非常低的延迟的情况下，比如电视电话会议的编码。</li>
    </ul>
  </li>
</ul>

<h5 id="详细参数说明">详细参数说明</h5>
<h6 id="1-prfile档次">1. prfile(档次)</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">序</th>
      <th style="text-align: center">name</th>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">8x8dct</th>
      <th style="text-align: center">cqm</th>
      <th style="text-align: center">bframes</th>
      <th style="text-align: center">cabac</th>
      <th style="text-align: center">weightp</th>
      <th style="text-align: center">interlaced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">baseline</td>
      <td style="text-align: center">基线</td>
      <td style="text-align: center">no</td>
      <td style="text-align: center">flat</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">no</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">no</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">main</td>
      <td style="text-align: center">主要</td>
      <td style="text-align: center">no</td>
      <td style="text-align: center">flat</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">high</td>
      <td style="text-align: center">高</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">high10</td>
      <td style="text-align: center">高10位</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
      <td style="text-align: center">不限</td>
    </tr>
  </tbody>
</table>

<p>详解：</p>
<ul>
  <li>bframes：在I帧与P帧之间可插入B帧数量（Number of B-frames）的最大值，范围0－16。</li>
  <li>cqm：自订量化矩阵（custom quantization matrices）。默认有flat和JVT。</li>
  <li>weightp：使x264能够使用明确加权预测（explicit weighted prediction）来改善P帧的压缩。亦改善淡入／淡出的品质。模式越高越慢。</li>
  <li>8x8dct：弹性8x8离散余弦转换（Adaptive 8x8 DCT）</li>
  <li>cabac：弹性内容的二进制算数编码（CABAC：Context Adaptive Binary Arithmetic Coder）。</li>
  <li>interlaced：隔行扫描。</li>
</ul>

<h6 id="2-preset预设">2 preset（预设）</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">序</th>
      <th style="text-align: center">name</th>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">b-adapt</th>
      <th style="text-align: center">bframes</th>
      <th style="text-align: center">direct</th>
      <th style="text-align: center">me</th>
      <th style="text-align: center">merange</th>
      <th style="text-align: center">partitions</th>
      <th style="text-align: center">rc-lookahead</th>
      <th style="text-align: center">ref</th>
      <th style="text-align: center">subme</th>
      <th style="text-align: center">trellis</th>
      <th style="text-align: center">weightp</th>
      <th style="text-align: center">other</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">ultrafast</td>
      <td style="text-align: center">极快</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">dia</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">none</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">no-8x8dct aq-mode0 no-cabac no-deblock no-mbtree no-mixed-refs scenecut0   no-weightb</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">superfast</td>
      <td style="text-align: center">超快</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">dia</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">i8x8,i4x4</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">no-mixed-refsno-mbtree</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">veryfast</td>
      <td style="text-align: center">很快</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">no-mixed-refs</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">faster</td>
      <td style="text-align: center">较快</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">20</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">4</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">no-mixed-refs</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">fast</td>
      <td style="text-align: center">快</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">30</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">6</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">1</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">medium</td>
      <td style="text-align: center">中</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">slow</td>
      <td style="text-align: center">慢</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">auto</td>
      <td style="text-align: center">umh</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">50</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">slower</td>
      <td style="text-align: center">较慢</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">auto</td>
      <td style="text-align: center">umh</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">all</td>
      <td style="text-align: center">60</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">9</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">9</td>
      <td style="text-align: center">veryslow</td>
      <td style="text-align: center">很慢</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">8</td>
      <td style="text-align: center">auto</td>
      <td style="text-align: center">umh</td>
      <td style="text-align: center">24</td>
      <td style="text-align: center">all 60</td>
      <td style="text-align: center">16</td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">10</td>
      <td style="text-align: center">placebo</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">16</td>
      <td style="text-align: center">auto</td>
      <td style="text-align: center">tesa</td>
      <td style="text-align: center">24</td>
      <td style="text-align: center">all</td>
      <td style="text-align: center">60</td>
      <td style="text-align: center">16</td>
      <td style="text-align: center">11</td>
      <td style="text-align: center">2</td>
      <td style="text-align: center">slow-firstpass no-fast-pskip</td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>参数详解：</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">b-adapt</code>：设定弹性B帧位置决策算法。此设定控制x264如何决定要放置P帧或B帧。</li>
  <li>
<code class="language-plaintext highlighter-rouge">bframes</code>：在I帧与P帧之间可插入B帧数量（Number of B-frames）的最大值，范围0－16。</li>
  <li>
<code class="language-plaintext highlighter-rouge">direct</code>：”direct”动态向量（motion vectors）的预测模式。有两种模式可用：<code class="language-plaintext highlighter-rouge">spatial</code>和<code class="language-plaintext highlighter-rouge">temporal</code>。可以指定<code class="language-plaintext highlighter-rouge">none</code>来停用<code class="language-plaintext highlighter-rouge">direct</code>动态向量，和指定<code class="language-plaintext highlighter-rouge">auto</code>来允许x264在两者之间切换为适合的模式。</li>
  <li>
<code class="language-plaintext highlighter-rouge">me</code>：全像素（<code class="language-plaintext highlighter-rouge">full-pixel</code>）运动估计（<code class="language-plaintext highlighter-rouge">motion estimation</code>）的算法。</li>
  <li>
<code class="language-plaintext highlighter-rouge">merange</code>：控制运动估计的最大范围（单位是像素）。对于<code class="language-plaintext highlighter-rouge">hex</code>和<code class="language-plaintext highlighter-rouge">dia</code>，范围限制在4~16。对于<code class="language-plaintext highlighter-rouge">umh</code>和<code class="language-plaintext highlighter-rouge">esa</code>，它可以增加到超过默认值16来允许范围更广的动态搜寻，对于HD视讯和高动态镜头很有用。注意，对于<code class="language-plaintext highlighter-rouge">umh</code>、<code class="language-plaintext highlighter-rouge">esa</code>和<code class="language-plaintext highlighter-rouge">tesa</code>，增加<code class="language-plaintext highlighter-rouge">merange</code>会大幅减慢编码速度。</li>
  <li>
<code class="language-plaintext highlighter-rouge">partitions</code>：H.264视讯在压缩过程中划分为16x16的宏区块。这些区块可以进一步划分为更小的分割，这就是此选项要控制的部分。</li>
  <li>
<code class="language-plaintext highlighter-rouge">rc-lookahead</code>：设定<code class="language-plaintext highlighter-rouge">mb-tree</code>位元率控制和<code class="language-plaintext highlighter-rouge">vbv-lookahead</code>使用的帧数。最大允许值是250。对于mb-tree部分，增加帧数带来更好的效果但也会更慢。<code class="language-plaintext highlighter-rouge">mb-tree</code>使用的最大缓冲值是<code class="language-plaintext highlighter-rouge">MIN(rc-lookahead, --keyint)</code>。</li>
  <li>
<code class="language-plaintext highlighter-rouge">ref</code>：控制解码图片缓冲（DPB：Decoded Picture Buffer）的大小。范围是从0到16。总之，此值是每个P帧可以使用先前多少帧作为参照帧的数目（B帧可以使用的数目要少一或两个，取决于它们是否作为参照帧）。可以被参照的最小ref数是1。</li>
  <li>
<code class="language-plaintext highlighter-rouge">subme</code>：设定子像素（subpixel）估算复杂度。值越高越好。层级1~5只是控制子像素细分（refinement）强度。层级6为模式决策启用RDO，而层级8为动态向量和内部预测模式启用RDO。RDO层级明显慢于先前的层级。
-<code class="language-plaintext highlighter-rouge"> trellis</code>：执行Trellis quantization来提高效率。</li>
  <li>
<code class="language-plaintext highlighter-rouge">weightp</code>：使x264能够使用明确加权预测（explicit weighted prediction）来改善P帧的压缩。亦改善淡入／淡出的品质。模式越高越慢。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-8x8dct</code>：停用弹性8x8离散余弦转换（Adaptive 8x8 DCT）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">aq-mode</code>：弹性量化模式。没有AQ时，x264很容易分配不足的位元数到细节较少的部分。AQ是用来更好地分配视讯里所有宏区块之间的可用位元数。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-cabac</code>：停用弹性内容的二进制算数编码（CABAC：Context Adaptive Binary Arithmetic Coder）资料流压缩，切换回效率较低的弹性内容的可变长度编码（CAVLC：Context Adaptive Variable Length Coder）系统。大幅降低压缩效率（通常10~20%）和解码的硬件需求。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-deblock</code>：停用循环筛选（loop filter。亦称为持续循环去区块(inloop deblocker)）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-mbtree</code>：停用宏区块树（macroblock tree）位元率控制。使用宏区块树位元率控制会改善整体压缩率，借由追踪跨帧的时间传播（temporal propagation）并相应地加权。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-mixed-refs</code>：混合参照会以每个8x8分割为基础来选取参照，而不是以每个宏区块为基础。当使用多个参照帧时这会改善品质，虽然要损失一些速度。设定此选项会停用该功能。</li>
  <li>
<code class="language-plaintext highlighter-rouge">scenecut</code>：设定I/IDR帧位置的阈值（场景变更侦测）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-weightb</code>：停用“加权”B帧的参照。</li>
  <li>
<code class="language-plaintext highlighter-rouge">slow-firstpass</code>：慢速pass。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-fast-pskip</code>：停用P帧的早期略过侦测（early skip detection）。非常轻微地提高品质，但要损失很多速度。</li>
</ul>

<h6 id="3-tune调校">3 tune（调校）</h6>

<table>
  <thead>
    <tr>
      <th style="text-align: center">序</th>
      <th style="text-align: center">name</th>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">ref</th>
      <th style="text-align: center">bframes</th>
      <th style="text-align: center">deblock</th>
      <th style="text-align: center">psy-rd</th>
      <th style="text-align: center">aq-strength</th>
      <th style="text-align: center">other</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">film</td>
      <td style="text-align: center">电影</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">-1:-1</td>
      <td style="text-align: left">0.15</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">animation</td>
      <td style="text-align: center">动画</td>
      <td style="text-align: center">{Double if &gt;1 else 1}</td>
      <td style="text-align: center">{+2}</td>
      <td style="text-align: center">1:1</td>
      <td style="text-align: right">0.4</td>
      <td style="text-align: center">0.6</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">grain</td>
      <td style="text-align: center">颗粒</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">-2:-2</td>
      <td style="text-align: left">0.25</td>
      <td style="text-align: center">0.5</td>
      <td style="text-align: center">no-dct-decimate deadzone-inter6 deadzone-intra6 ipratio1.1 pbratio1.1   qcomp0.8</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">stillimage</td>
      <td style="text-align: center">静态图像</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">-3:-3</td>
      <td style="text-align: center">2.0:0.7</td>
      <td style="text-align: center">1.2</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">psnr</td>
      <td style="text-align: center">PSNR测试</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">no</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">aq-mode0</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">ssim</td>
      <td style="text-align: center">SSIM测试</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">no</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">aq-mode2</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">fastdecode</td>
      <td style="text-align: center">快速解码</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">no</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">no-cabac no-weightb weightp0</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">zerolatency</td>
      <td style="text-align: center">零延迟</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">0</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">force-cfr no-mbtree sync-lookahead0 sliced-threads rc-lookahead0</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">ref</code>：控制解码图片缓冲（DPB：Decoded Picture Buffer）的大小。范围是从0到16。总之，此值是每个P帧可以使用先前多少帧作为参照帧的数目（B帧可以使用的数目要少一或两个，取决于它们是否作为参照帧）。可以被参照的最小ref数是1。</li>
  <li>
<code class="language-plaintext highlighter-rouge">bframes</code>：在I帧与P帧之间可插入B帧数量（Number of B-frames）的最大值，范围0－16。</li>
  <li>
<code class="language-plaintext highlighter-rouge">deblock</code>：控制循环筛选（亦称为持续循环去区块(inloop deblocker)）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">psy-rd</code>：第一个数是Psy-RDO的强度（需要subme&gt;=6）。第二个数是Psy-Trellis的强度（需要trellis&gt;=1）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">aq-strength</code>：弹性量化强度。设定AQ偏向低细节（平面）的宏区块之强度。不允许为负数。0.0~2.0以外的值不建议。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-dct-decimate</code>：停用DCT Decimation。DCT Decimation会舍弃它认为“不必要的”DCT区块。这会改善编码效率，而降低的品质通常微不足道。</li>
  <li>
<code class="language-plaintext highlighter-rouge">deadzone-inter/intra</code>：设定inter/intra亮度量化反应区（deadzone）的大小。反应区的范围应该在0~32。此值设定x264会任意舍弃而不尝试保留细微细节的层级。非常细微的细节既难以看见又耗费位元数，舍弃这些细节可以不用浪费位元数在视讯的此类低收益画面上。反应区与–trellis不相容。</li>
  <li>
<code class="language-plaintext highlighter-rouge">ipratio</code>：修改I帧量化值相比P帧量化值的目标平均增量。越大的值会提高I帧的品质。</li>
  <li>
<code class="language-plaintext highlighter-rouge">pbratio</code>：修改B帧量化值相比P帧量化值的目标平均减量。越大的值会降低B帧的品质。当mbtree启用时（默认启用），此设定无作用，mbtree会自动计算最佳值。</li>
  <li>
<code class="language-plaintext highlighter-rouge">qcomp</code>：量化值曲线压缩系数。0.0是固定位元率，1.0则是固定量化值。当mbtree启用时，它会影响mbtree的强度（qcomp越大，mbtree越弱）。</li>
  <li>
<code class="language-plaintext highlighter-rouge">aq-mode</code>：弹性量化模式。没有AQ时，x264很容易分配不足的位元数到细节较少的部分。AQ是用来更好地分配视讯里所有宏区块之间的可用位元数。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-cabac</code>：停用弹性内容的二进制算数编码（CABAC：Context Adaptive Binary Arithmetic Coder）资料流压缩，切换回效率较低的弹性内容的可变长度编码（CAVLC：Context Adaptive Variable Length Coder）系统。大幅降低压缩效率（通常10~20%）和解码的硬件需求。</li>
  <li>
<code class="language-plaintext highlighter-rouge">weightp</code>：使x264能够使用明确加权预测（explicit weighted prediction）来改善P帧的压缩。亦改善淡入／淡出的品质。模式越高越慢。</li>
  <li>
<code class="language-plaintext highlighter-rouge">force-cfr</code>：如果使用 ffms2 或 lavf 分离器，且输出文件不是 raw 格式，则从输入文件复制时间码。此选项关闭这个功能，并强制 x264 自己产生。当使用此选项时估计你也会设置 –fps。</li>
  <li>
<code class="language-plaintext highlighter-rouge">no-mbtree</code>：停用宏区块树（macroblock tree）位元率控制。使用宏区块树位元率控制会改善整体压缩率，借由追踪跨帧的时间传播（temporal propagation）并相应地加权。</li>
  <li>
<code class="language-plaintext highlighter-rouge">sync-lookahead</code>：设置用于线程预测的帧缓存大小。最大值是250。在第二遍及更多遍编码或基于分片线程时自动关闭。设为0将关闭线程预测，将减小延迟，但是以降低性能为代价。</li>
  <li>
<code class="language-plaintext highlighter-rouge">sliced-threads</code>：开启基于分片的线程。比默认方式质量低、效率低，但是没有编码延迟。</li>
  <li>
<code class="language-plaintext highlighter-rouge">rc-lookahead</code>：设定mb-tree位元率控制和vbv-lookahead使用的帧数。最大允许值是250。对于mb-tree部分，增加帧数带来更好的效果但也会更慢。mb-tree使用的最大缓冲值是MIN(rc-lookahead, –keyint)。</li>
</ul>

<h3 id="api-使用和解析">API 使用和解析</h3>
<p><em>參考鏈接：</em> <a href="https://code.videolan.org/videolan/x264/">源碼地址</a>;<a href="https://blog.csdn.net/vince025/article/details/80328134">x264编码demo</a>;</p>
<h4 id="x264簡單使用代碼">x264簡單使用代碼</h4>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// x264t.cpp : Defines the entry point for the console application.</span>
<span class="c1">//</span>
 
<span class="cp">#include "stdint.h"
</span> 
<span class="cp">#ifndef _DEBUG
#pragma comment(lib, "libx264.lib")//加載lib
#else
#pragma comment(lib, "libx264d.lib")//加載lib
#endif
</span> 
<span class="cp">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
</span><span class="c1">//加入頭文件</span>
<span class="cp">#include "x264.h"
</span> 
 
<span class="k">typedef</span> <span class="kt">char</span> <span class="kt">bool</span><span class="p">;</span>
<span class="cp">#define false 0;
#define true 1;
</span> <span class="c1">//编码图片帧</span>
<span class="kt">bool</span> <span class="nf">x264_encode_frame</span><span class="p">(</span> <span class="n">x264_t</span> <span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="c1">//x264解码原型对象，x264_t是一个控制X264编码的全局性结构体，该结构体控制着视频一帧一帧的编码，包括中间参考帧管理、码率控制、全局参数等一些重要参数和结构体。详见源码：https://code.videolan.org/videolan/x264/blob/master/common/common.h</span>
                        <span class="n">x264_param_t</span> <span class="o">*</span><span class="n">param</span><span class="p">,</span><span class="c1">//结构体参数</span>
                        <span class="n">x264_picture_t</span><span class="o">*</span> <span class="n">pic_in</span><span class="p">,</span><span class="c1">//输入图片</span>
                        <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">data_out</span><span class="p">,</span><span class="c1">//数据输出</span>
                        <span class="kt">int</span><span class="o">*</span> <span class="n">data_out_len</span><span class="p">,</span><span class="c1">//输出长度</span>
                        <span class="kt">bool</span><span class="o">*</span> <span class="n">key_frame</span><span class="p">);</span><span class="c1">//是否为关键帧</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
        <span class="c1">//获取输入参数</span>
        <span class="kt">char</span> <span class="o">*</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="c1">//输入文件</span>
        <span class="kt">char</span> <span class="o">*</span><span class="n">out_file</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="c1">//输出文件</span>
        <span class="kt">FILE</span>  <span class="o">*</span><span class="n">fp_in</span><span class="p">;</span><span class="c1">//输入文件句柄</span>
        <span class="kt">FILE</span>  <span class="o">*</span><span class="n">fp_out</span><span class="p">;</span><span class="c1">//输出文件句柄</span>
        <span class="c1">//预设相关参数</span>
        <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="c1">//图片宽度</span>
            <span class="n">height</span><span class="p">,</span> <span class="c1">//图片高度</span>
            <span class="n">frame_size</span><span class="p">,</span><span class="c1">//帧大小 </span>
            <span class="n">plane0_size</span><span class="p">,</span><span class="c1">//0通道大小</span>
            <span class="n">plane1_size</span><span class="p">,</span><span class="c1">//1通道大小</span>
            <span class="n">plane2_size</span><span class="p">;</span><span class="c1">//2通道大小</span>
 
        <span class="n">x264_param_t</span> <span class="n">param</span><span class="p">;</span><span class="c1">//设置x264参数</span>
        <span class="n">x264_t</span> <span class="o">*</span><span class="n">h</span><span class="p">;</span><span class="c1">//x264关键结构体</span>
        <span class="n">x264_picture_t</span> <span class="n">pic</span><span class="p">;</span><span class="c1">//输入图片</span>
        <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="c1">//缓冲</span>
        <span class="kt">int</span>  <span class="n">actual_read_size</span><span class="p">;</span><span class="c1">//读取到的大小</span>
        <span class="kt">bool</span> <span class="n">key_frame</span><span class="p">;</span><span class="c1">//是否为，关键帧，</span>
        <span class="c1">//存在多余参数</span>
        <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//获取输出宽高</span>
            <span class="n">sscanf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s">"%dx%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">width</span><span class="p">,</span><span class="o">&amp;</span><span class="n">height</span><span class="p">);</span>
            <span class="c1">//设置各个通道大小</span>
            <span class="n">plane0_size</span> <span class="o">=</span> <span class="n">plane1_size</span> <span class="o">=</span> <span class="n">plane2_size</span> <span class="o">=</span> <span class="n">height</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>
                <span class="c1">//判断YUV编码类型和方法：</span>
                <span class="c1">//4\:4\:4表示完全取样。</span>
                <span class="c1">//4\:2\:2表示2:1的水平取样，垂直完全采样。</span>
                <span class="c1">//4\:2\:0表示2:1的水平取样，垂直2：1采样。</span>
                <span class="c1">//4\:1\:1表示4:1的水平取样，垂直完全采样。</span>
                <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="s">"444"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="n">param</span><span class="p">.</span><span class="n">i_csp</span> <span class="o">=</span> <span class="n">X264_CSP_I444</span><span class="p">;</span><span class="c1">//设置采样参数</span>
                        <span class="c1">//为图片分配内存大小</span>
                        <span class="n">x264_picture_alloc</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pic</span><span class="p">,</span> <span class="n">X264_CSP_I444</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="s">"422"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="n">param</span><span class="p">.</span><span class="n">i_csp</span> <span class="o">=</span> <span class="n">X264_CSP_I422</span><span class="p">;</span>
                        <span class="c1">//垂直采样取半</span>
                        <span class="n">plane1_size</span> <span class="o">=</span> <span class="n">plane2_size</span> <span class="o">=</span> <span class="n">plane0_size</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                        <span class="n">x264_picture_alloc</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pic</span><span class="p">,</span> <span class="n">X264_CSP_I422</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="cm">/*if(strcmp(argv[4],"420") == 0)*/</span>
                <span class="p">{</span>
                        <span class="n">param</span><span class="p">.</span><span class="n">i_csp</span> <span class="o">=</span> <span class="n">X264_CSP_I420</span><span class="p">;</span>
                        <span class="n">plane1_size</span> <span class="o">=</span> <span class="n">plane2_size</span> <span class="o">=</span> <span class="n">plane0_size</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
                        <span class="n">x264_picture_alloc</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pic</span><span class="p">,</span> <span class="n">X264_CSP_I420</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="c1">//确定帧大小=通道1size+通道2size+通道3size</span>
                <span class="n">frame_size</span> <span class="o">=</span> <span class="n">plane0_size</span> <span class="o">+</span> <span class="n">plane1_size</span> <span class="o">+</span> <span class="n">plane2_size</span><span class="p">;</span>
                <span class="c1">//分配缓存</span>
                <span class="n">buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">frame_size</span><span class="p">);</span>
                <span class="c1">//设置默认参数</span>
                <span class="n">x264_param_default</span><span class="p">(</span><span class="n">param</span><span class="p">);</span>
                <span class="c1">//设置编码参数</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_threads</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_width</span> <span class="o">=</span> <span class="n">width</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_height</span> <span class="o">=</span> <span class="n">height</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_bframe</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>        
                <span class="n">param</span><span class="p">.</span><span class="n">i_frame_reference</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">rc</span><span class="p">.</span><span class="n">i_rc_method</span><span class="o">=</span><span class="n">X264_RC_CQP</span> <span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_csp</span> <span class="o">=</span> <span class="n">X264_CSP_I420</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">b_visualize</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">i_log_level</span><span class="o">=</span><span class="n">X264_LOG_NONE</span><span class="p">;</span>
                <span class="n">param</span><span class="p">.</span><span class="n">pf_log</span> <span class="o">=</span> <span class="n">printf</span><span class="p">;</span>
                <span class="c1">//初始化文件和编码器</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">h</span> <span class="o">=</span> <span class="n">x264_encoder_open</span><span class="p">(</span><span class="n">param</span> <span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
                <span class="p">{</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">((</span><span class="n">fp_in</span> <span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span><span class="s">"rb"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="n">puts</span><span class="p">(</span><span class="s">"打开输入文件失败"</span><span class="p">);</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
 
                <span class="k">if</span><span class="p">((</span><span class="n">fp_out</span> <span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span><span class="s">"wb"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="n">puts</span><span class="p">(</span><span class="s">"打开输出文件失败"</span><span class="p">);</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
 
                <span class="k">do</span>
                <span class="p">{</span>
                    <span class="c1">//读取视频文件帧大小</span>
                    <span class="n">actual_read_size</span> <span class="o">=</span> <span class="n">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">frame_size</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fp_in</span><span class="p">);</span>
                        <span class="c1">//读取到1帧则开始编码</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">actual_read_size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="p">{</span>
                                <span class="n">actual_read_size</span><span class="o">=</span> <span class="n">frame_size</span><span class="p">;</span>
                                <span class="c1">//拷贝图像</span>
                                <span class="n">memcpy</span><span class="p">(</span><span class="n">pic</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">plane</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">plane0_size</span><span class="p">);</span>
                                <span class="n">memcpy</span><span class="p">(</span><span class="n">pic</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">plane</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">buffer</span> <span class="o">+</span> <span class="n">plane0_size</span><span class="p">,</span> <span class="n">plane1_size</span><span class="p">);</span>
                                <span class="n">memcpy</span><span class="p">(</span><span class="n">pic</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">plane</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">buffer</span> <span class="o">+</span> <span class="n">plane0_size</span> <span class="o">+</span> <span class="n">plane1_size</span><span class="p">,</span> <span class="n">plane2_size</span><span class="p">);</span>
 
                                <span class="n">pic</span><span class="p">.</span><span class="n">i_pts</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">param</span><span class="p">.</span><span class="n">i_frame_total</span> <span class="o">*</span> <span class="n">param</span><span class="p">.</span><span class="n">i_fps_den</span><span class="p">;</span>
                                <span class="c1">//编码</span>
                                <span class="n">x264_encode_frame</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pic</span><span class="p">,</span><span class="n">buffer</span><span class="p">,</span><span class="o">&amp;</span><span class="n">actual_read_size</span><span class="p">,</span><span class="o">&amp;</span><span class="n">key_frame</span><span class="p">);</span>
                                
                                <span class="n">fwrite</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="n">actual_read_size</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fp_out</span><span class="p">);</span>
                                <span class="n">flushall</span><span class="p">();</span>
                        <span class="p">}</span>
                        <span class="k">else</span>
                        <span class="p">{</span>
                                <span class="n">fseek</span><span class="p">(</span> <span class="n">fp_in</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_SET</span> <span class="p">);</span>
                        <span class="p">}</span>
                        <span class="c1">//帧数加一</span>
                        <span class="n">param</span><span class="p">.</span><span class="n">i_frame_total</span> <span class="o">++</span><span class="p">;</span>
 
                <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
 
                <span class="c1">//清除图片</span>
                <span class="n">x264_picture_clean</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pic</span> <span class="p">);</span>
                <span class="c1">//关闭解码器</span>
                <span class="n">x264_encoder_close</span><span class="p">(</span> <span class="n">h</span> <span class="p">);</span>
                <span class="c1">//清除缓存</span>
                <span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
                <span class="c1">//关闭文件</span>
                <span class="n">fclose</span><span class="p">(</span><span class="n">fp_out</span><span class="p">);</span>
                <span class="n">fclose</span><span class="p">(</span><span class="n">fp_in</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="s">"参数错误!"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">bool</span> <span class="nf">x264_encode_frame</span><span class="p">(</span><span class="n">x264_t</span> <span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">x264_param_t</span> <span class="o">*</span><span class="n">param</span><span class="p">,</span> <span class="n">x264_picture_t</span><span class="o">*</span> <span class="n">pic_in</span><span class="p">,</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">data_out</span><span class="p">,</span><span class="kt">int</span><span class="o">*</span> <span class="n">data_out_len</span><span class="p">,</span> <span class="kt">bool</span><span class="o">*</span> <span class="n">key_frame</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="n">x264_picture_t</span> <span class="n">pic_out</span><span class="p">;</span><span class="c1">//结构体描述一视频帧的特征，该结构体定义在x264.h中。</span>
        <span class="n">x264_nal_t</span> <span class="o">*</span><span class="n">nal</span><span class="p">;</span><span class="c1">//264_nal_t中的数据在下一次调用x264_encoder_encode之后就无效了，因此必须在调用x264_encoder_encode 或 x264_encoder_headers 之前使用或拷贝其中的数据。记录编码后获得的NAL单元个数</span>
        <span class="kt">int</span> <span class="n">i_nal</span><span class="p">,</span><span class="n">i</span><span class="p">;</span><span class="c1">//nal单元首地址和辅助遍历</span>
        <span class="kt">int</span> <span class="n">i_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//每个NAL单元长度</span>
        <span class="kt">int</span> <span class="n">data_out_l</span> <span class="o">=</span> <span class="o">*</span><span class="n">data_out_len</span><span class="p">;</span><span class="c1">//剩余长度</span>
        <span class="o">*</span><span class="n">data_out_len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="c1">//开始解码</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">x264_encoder_encode</span><span class="p">(</span> <span class="n">h</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nal</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i_nal</span><span class="p">,</span> <span class="n">pic_in</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pic_out</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="p">{</span>
                <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
 
        <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">i_nal</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
                <span class="n">i_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">i_size</span> <span class="o">=</span> <span class="n">x264_nal_encode</span><span class="p">(</span> <span class="n">data_out</span> <span class="o">+</span> <span class="o">*</span><span class="n">data_out_len</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_out_l</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
                <span class="p">{</span>
                        <span class="o">*</span><span class="n">data_out_len</span> <span class="o">+=</span> <span class="n">i_size</span><span class="p">;</span>
                        <span class="n">data_out_l</span> <span class="o">-=</span> <span class="n">i_size</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
 
        <span class="k">if</span><span class="p">(</span><span class="n">pic_out</span><span class="p">.</span><span class="n">i_type</span><span class="o">==</span><span class="n">X264_TYPE_IDR</span><span class="p">)</span>
                <span class="o">*</span><span class="n">key_frame</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>
<h4 id="x264函数功能总结">x264函数功能总结</h4>
<p><em>参考链接：</em> <a href="https://blog.csdn.net/charleslei/article/details/52305632">X264函数功能总结</a>;<a href="https://blog.csdn.net/Jammg/article/details/53443167">x264头文件结构体详解</a>;<a href="https://blog.csdn.net/qq_41051855/article/details/79051667">FFmpeg实时解码H264</a>;</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">函数名称</th>
      <th style="text-align: center">位置</th>
      <th style="text-align: center">完成功能</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_filter</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">帧滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_init_lowres </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">亮度1/2像素值初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mc_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">运动估计初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void motion_compensation_chroma </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">色度运动估计</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static uint8_t *get_ref </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">获取参考亮度像素</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void mc_luma </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\mc.c</code></td>
      <td style="text-align: center">亮度运动估计　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_param_default </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">设置缺省参数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_log </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">定义log级别</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_log_default </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">设置缺省日志参数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_picture_alloc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">设置picture参数,根据输出图像格式分配空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_picture_clean </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">释放分配的图像空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_nal_encode </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">nal单元编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_nal_decode </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">nal单元解码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void *x264_malloc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">X264内部定义的内存分配</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_free </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">X264内存释放</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void *x264_realloc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">X264重新分配图像空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_reduce_fraction </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">分数化简</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">char *x264_slurp_file </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">将文件读入分配的缓存区</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">char *x264_param2string </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\common.c</code></td>
      <td style="text-align: center">转换参数为字符串,返回字符串存放的地址</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_context_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">CABAC上下文取值表初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_decode_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">CABAC解码流初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_decode_renorm </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">CABAC解码重新标准化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cabac_decode_decision </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cabac_decode_bypass </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cabac_decode_terminal </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_encode_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_putbit </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_encode_renorm </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_encode_decision </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_encode_bypass </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_encode_terminal </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_encode_flush </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_size_decision </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cabac_size_decision2 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int 264_cabac_size_decision_noup </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline int clip_uint8 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">clip3(x,0,255)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void dct2x2dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">2<em>2直流系数的Hadamard变换,以4</em>4变换为基础</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void dct4x4dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">4*4DC系数的Hadamard变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void idct4x4dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">每行每列一维蝶形快速算法,完成d[4][4]的Hadamard反变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void sub4x4_dct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">对4*4残差进行DCT变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void sub8x8_dct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">对8*8残差进行DCT变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void sub16x16_dct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">对16*16残差进行DCT变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void add4x4_idct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">残差块DCT反变换后,加到预测块上,重构4*4块</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void add8x8_idct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">残差块DCT反变换后,加到预测块上,重构8*8块</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void add16x16_idct </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">残差块DCT反变换后,加到预测块上,重构16*16块</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_dct_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\dct.c</code></td>
      <td style="text-align: center">DCT运算初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void quant_8x8_core </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">8*8 AC量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void quant_4x4_core </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">4*4 AC量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void quant_4x4_dc_core </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">4*4 亮度DC量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void quant_2x2_dc_core </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">2*2 色度DC量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void dequant_4x4 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">4*4 AC反量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void dequant_8x8 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">8*8 AC反量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_dequant_2x2_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">2*2 色度DC反量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_dequant_4x4_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">4*4 亮度DC反量化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_quant_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\quant.c</code></td>
      <td style="text-align: center">量化参量初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">x264_frame_t *x264_frame_new </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">创建新帧</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_delete </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">删除帧,释放空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_copy_picture </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">将图像拷贝到帧中</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void plane_expand_border </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">边界扩展(被其他具体的扩展函数调用)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_expand_border </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧边界扩展</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_expand_border_filtered </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">为滤波进行的边界扩展</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_expand_border_lowres </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">为计算亮度半像素值进行边界扩展</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_expand_border_mod16 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧边界不是16整数倍时进行边界扩展</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void deblock_luma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">bs=1~3时,修正亮度MB边界的p0和q0值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_v_luma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">亮度分量垂直边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_h_luma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">亮度分量水平边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void deblock_chroma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">bs=1~3时,修正色度MB边界的p0和q0值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_v_chroma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">色度分量垂直边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_h_chroma_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">色度分量水平边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void deblock_luma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">bs=4时,修正亮度MB边界的值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_v_luma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧内亮度分量垂直边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_h_luma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧内亮度分量水平边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void deblock_chroma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">bs=4时,修正色度MB边界的值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_v_chroma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧内色度分量垂直边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void deblock_h_chroma_intra_c </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧内色度分量水平边界去块滤波</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void deblock_edge </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">bs值确定</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_frame_deblocking_filter </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">帧去块滤波主函数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_deblock_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\frame.c</code></td>
      <td style="text-align: center">去块滤波初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_mb_predict_intra4x4_mode </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">帧内4*4块模式预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_mb_predict_non_zero_code </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">非零</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_mb_transform_8x8_allowed </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">判断当前宏块是否允许8*8变换</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_predict_mv </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">宏块运动矢量预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_predict_mv_16x16 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">16*16块MV预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_predict_mv_pskip </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">Pskip块MV预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int x264_mb_predict_mv_direct16x16_temporal </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">直接模式16*16块MV时间预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int x264_mb_predict_mv_direct16x16_spatial </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">直接模式16*16块MV空间预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_mb_predict_mv_direct16x16 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">直接模式16*16块MV预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_load_mv_direct8x8 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">直接模式8*8块MV加载</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_predict_mv_ref16x16 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">16*16参考块MV预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_mb_mc_0xywh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">前向宏块运动补偿</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_mb_mc_1xywh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">后向宏块运动补偿</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_mb_mc_01xywh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">宏块双向运动补偿</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_mb_mc_direct8x8 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">直接模式8*8块运动补偿</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_mc_8x8 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">各种类型8*8块及其分割的运动补偿</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_mb_mc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">各种类型块运动补偿(调用以上各MC子函数)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_cache_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">初始化表征宏块的各变量,分配内存空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_cache_end </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">释放为宏块分配的cache空间</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_slice_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">初始MB与slice映射关系</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_cache_load </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">宏块cache加载,所有宏块表征变量赋值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_cache_save </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">保存cache中的变量值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_bipred_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\macroblock.c</code></td>
      <td style="text-align: center">宏块双向预测初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int64_t x264_pixel_ssd_wxh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\pixel.c</code></td>
      <td style="text-align: center">计算像素差值平方和</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void pixel_sub_wxh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\pixel.c</code></td>
      <td style="text-align: center">计算像素差</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int pixel_satd_wxh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\pixel.c</code></td>
      <td style="text-align: center">计算4*4hardmard变换后的绝对误差和</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline int pixel_sa8d_wxh </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\pixel.c</code></td>
      <td style="text-align: center">计算8*8hardmard变换后的绝对误差和</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">上和左邻块可用时,帧内16*16亮度块DC模式预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_dc_left </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">左边邻块可用时,帧内16*16亮度块DC模式预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_dc_top </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">上边邻块可用时,帧内16*16亮度块DC模式预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_dc_128 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">邻块均不可用时,帧内16*16亮度块预测DC模式,预测值为128</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_h </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内16*16亮度块水平预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_v </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内16*16亮度块垂直预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_16x16_p </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内16*16亮度块平面预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_128 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_left </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_top </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_h </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_v </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_p </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_dc_128 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_dc_left </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_dc_top </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_h </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_v </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4c_p </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_ddl </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式3 左下对角预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_ddr </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式4 右下对角预测</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_vr </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式5 垂直左下角</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_hd </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式6 水平斜下角</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_vl </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式7 垂直左下角</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_4x4_hu </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">模式8 水平斜上角</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_128 </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_left </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc_top </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_dc </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_h </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_v </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8c_p </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_ddl </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_ddr </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_vr </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_hd </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_vl </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void predict_8x8_hu </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_predict_16x16_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内16*16亮度块预测模式初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_predict_8x8c_init( int cpu, x264_predict8x8_t pf[7] ) </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内8*8亮度块预测模式初始化(7种模式)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_predict_8x8c_init( int cpu, x264_predict8x8_t pf[12] ) </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内8*8亮度块预测模式初始化(12种模式)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_predict_4x4_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\predict.c</code></td>
      <td style="text-align: center">帧内4*4亮度块预测模式初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cqm_init </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\set.c</code></td>
      <td style="text-align: center">量化矩阵初始化</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cqm_parse_jmlist </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\set.c</code></td>
      <td style="text-align: center">分析量化矩阵列表的正确性</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_cqm_parse_file </code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">common\set.c</code></td>
      <td style="text-align: center">分析量化矩阵文件的正确性</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_encode_ue_bypass</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">无符号指标GOLOMB编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_type_intra</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块帧内类型cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_type</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块类型cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_intra4x4_pred_mode</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">4*4帧内亮度块预测模式cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_intra_chroma_pred_mode</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">帧内色度块预测模式cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_cbp_luma</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块亮度cbp值cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_cbp_chroma</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块色度cbp值cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_cabac_mb_qp_delta</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块增量量化参数cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_cabac_mb_skip</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">可跳过宏块cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_sub_p_partition</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">8*8子宏块分割cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_sub_b_partition</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">B帧8*8子宏块各种分割cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_transform_size</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块变换块尺寸cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_ref</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">参考宏块cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_mvd_cpn</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块的mvd进行cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb_mvd</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">计算并保存宏块mvd,调用上个函数对mvd进行cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_cabac_mb8x8_mvd</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">8*8宏块mvd的cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int x264_cabac_mb_cbf_ctxidxinc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">返回宏块左边和上边块非0像素的个数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void block_residual_write_cabac</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">残差块cabac编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_write_cabac</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块cabac编码主函数(调用以上各子函数)</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">定义RD时使用</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_partition_size_cabac</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">宏块分割cabac编码主函数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_partition_i8x8_size_cabac</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void x264_partition_i4x4_size_cabac</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cabac.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void block_residual_write_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">残差块cavlc编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void cavlc_qp_delta</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">量化参数增量cavlc编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void cavlc_mb_mvd</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">运动矢量差值cavlc编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void cavlc_mb8x8_mvd</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">8*8子宏块运动矢量差值cavlc编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static inline void x264_macroblock_luma_write_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">亮度宏块cavlc编码</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_macroblock_write_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">宏块cavlc编码主函数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">#ifdef RDO_SKIP_BS时使用下列</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_partition_size_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int cavlc_intra4x4_pred_size</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int x264_partition_i8x8_size_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int x264_partition_i4x4_size_cavlc</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\cavlc.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static double pop</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">出栈</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void push</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">入栈</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static int strmatch</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">串匹配</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void evalPrimary</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">一些常用计算</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void evalPow</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">运算式分析或计算</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void evalFactor</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">求幂运算</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void evalTerm</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void evalExpression</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">　</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">double x264_eval</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\eval.c</code></td>
      <td style="text-align: center">输入运算变量和运算符,功能调用运算表达式分析函数</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_me_search_ref</code></td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">encoder\me.c</code></td>
      <td style="text-align: center">运动估计搜索</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_me_refine_qpel</code></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">亚像素运动估计</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">static void refine_subpel</code></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">亚像素运动估计搜索</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int x264_me_refine_bidir</code></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">双向运动估计</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">void x264_me_refine_qpel_rd</code></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">有率失真的亚像素运动估计</td>
    </tr>
  </tbody>
</table>

<h4 id="x264源码分析和总结">x264源码分析和总结</h4>
<p><em>参考链接：</em> <a href="https://blog.csdn.net/leixiaohua1020/article/details/45536607">x264源代码简单分析：概述</a>;</p>

<p><img src="https://img-my.csdn.net/uploads/201505/06/1430897637_6272.jpg" alt="源码结构图"></p>



                <hr style="visibility: hidden;">

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/04/17/work_find/" data-toggle="tooltip" data-placement="top" title="找工作学习计划">
                        Previous<br>
                        <span>找工作学习计划</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2019/04/25/cplusplus_primer_learn_note_2/" data-toggle="tooltip" data-placement="top" title="C++ Primer 学习笔记 (二)">
                        Next<br>
                        <span>C++ Primer 学习笔记 (二)</span>
                        </a>
                    </li>
                    
                </ul>


                <!--Gitalk评论start  -->
                
                <!-- 引入Gitalk评论插件  -->
                <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
                <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
                <div id="gitalk-container"></div>
                <!-- 引入一个生产md5的js，用于对id值进行处理，防止其过长 -->
                <!-- Thank DF:https://github.com/NSDingFan/NSDingFan.github.io/issues/3#issuecomment-407496538 -->
                <script src="/js/md5.min.js"></script>
                <script type="text/javascript">
                    var gitalk = new Gitalk({
                    clientID: '0224d5b04da044c201d4',
                    clientSecret: 'ccd26d0c1d8d4cc3377be7cb388f854ad2b4e5d0',
                    repo: 'wangpengcheng.github.io',
                    owner: 'wangpengcheng',
                    admin: ['wangpengcheng'],
                    distractionFreeMode: true,
                    id: md5(location.pathname),
                    });
                    gitalk.render('gitalk-container');
                </script>
                
                <!-- Gitalk end -->

                

            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#C++" title="C++" rel="37">
                                    C++
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A8%8B" title="基础编程" rel="24">
                                    基础编程
                                </a>
                            
        				
                            
                				<a href="/tags/#C/C++" title="C/C++" rel="26">
                                    C/C++
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91" title="后台开发" rel="11">
                                    后台开发
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B" title="网络编程" rel="8">
                                    网络编程
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#STL%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90" title="STL源码解析" rel="4">
                                    STL源码解析
                                </a>
                            
        				
                            
                				<a href="/tags/#Linux" title="Linux" rel="17">
                                    Linux
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F" title="操作系统" rel="12">
                                    操作系统
                                </a>
                            
        				
                            
                				<a href="/tags/#%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1" title="程序设计" rel="14">
                                    程序设计
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E4%BC%98%E5%8C%96" title="优化" rel="4">
                                    优化
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#UML" title="UML" rel="4">
                                    UML
                                </a>
                            
        				
                            
                				<a href="/tags/#UNIX" title="UNIX" rel="5">
                                    UNIX
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" title="学习笔记" rel="7">
                                    学习笔记
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#%E9%9D%A2%E8%AF%95" title="面试" rel="5">
                                    面试
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Java" title="Java" rel="9">
                                    Java
                                </a>
                            
        				
                            
                				<a href="/tags/#%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0" title="读书笔记" rel="6">
                                    读书笔记
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://zhengwuyang.com">WY</a></li>
                    
                        <li><a href="http://www.jianshu.com/u/e71990ada2fd">简书·BY</a></li>
                    
                        <li><a href="https://apple.com">Apple</a></li>
                    
                        <li><a href="https://developer.apple.com/">Apple Developer</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        // BY Fix:去除标题前的‘#’ issues:<https://github.com/qiubaiying/qiubaiying.github.io/issues/137>
        // anchors.options = {
        //   visible: 'always',
        //   placement: 'right',
        //   icon: '#'
        // };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <!-- add jianshu add target = "_blank" to <a> by BY -->
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    


                    
                    <li>
                        <a target="_blank" href="https://www.facebook.com/baiying.qiu.7">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/wangpengcheng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright © My Blog 2022
                    <br>
                    Theme on <a href="https://github.com/wangpengcheng/wangpengcheng.github.io.git">GitHub</a> |
                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px" height="20px" src="https://ghbtns.com/github-btn.html?user=wangpengcheng&repo=wangpengcheng.github.io&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '4b4b33b70559d548603afcd03258bacb';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>







<!-- Image to hack wechat -->
<img src="/img/apple-touch-icon.png" width="0" height="0">
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
